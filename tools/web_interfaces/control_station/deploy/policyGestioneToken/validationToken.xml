<config id="validationToken" 
	label="Validazione" 
	xmlns="http://www.openspcoop2.org/core/mvc/properties" 
	provider="org.openspcoop2.pdd.core.token.TokenProvider">

	<properties>
		<collection name="signaturePropRefId"/>
		<collection name="encryptionPropRefId"/>
		<collection name="signatureVerificationPropRefId"/>
		<collection name="decryptionPropRefId"/>
		<collection name="endpointConfig"/>
		<collection name="sslConfig"/>
		<collection name="sslClientConfig"/>
		<collection name="validazioneJwtTokenParserPropRefId"/>
		<collection name="introspectionTokenParserPropRefId"/>
		<collection name="userInfoTokenParserPropRefId"/>
	</properties>
	
	<section label="Informazioni Generali">
		
		<!--
		Se non definito viene preso il nome della policy creata  
		<item type="hidden" name="policyRealm" value="ValoreREALM">
			<property name="policy.realm" force="true"/>
		</item>
		-->
		<item type="hidden" name="policyForceEmptyMessageError" value="false">
			<property name="policy.messageError.bodyEmpty" force="true"/>
		</item>
		<item type="hidden" name="policyGenericError" value="true">
			<property name="policy.messageError.genericMessage" force="true"/>
		</item>
				
		<subsection label="Token">
		
			<item type="select" name="tokenType" label="Tipo" default="opaque" reloadOnChange="true">
				<values>
					<value value="opaque" label="Opaco"/>
					<value value="jws" label="JWS"/>
					<value value="jwe" label="JWE"/>
				</values>
				<property name="policy.token.type" />
			</item>
		
			<item type="select" name="tokenSource" label="Posizione" default="RFC6750" reloadOnChange="true">
				<values>
					<value value="RFC6750" label="RFC 6750 - Bearer Token Usage"/>
					<value value="RFC6750_header" label="RFC 6750 - Bearer Token Usage (Authorization Request Header Field)"/>
					<value value="RFC6750_form" label="RFC 6750 - Bearer Token Usage (Form-Encoded Body Parameter)"/>
					<value value="RFC6750_url" label="RFC 6750 - Bearer Token Usage (URI Query Parameter)"/>
					<value value="CUSTOM_header" label="Header HTTP"/>
					<value value="CUSTOM_url" label="Parametro URL"/>
				</values>
				<property name="policy.token.source" />
			</item>
			
			<item type="text" name="tokenSourceHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition>
						<equals name="tokenSource" value="CUSTOM_header"/>
					</condition>
				</conditions>
			    <property name="policy.token.source.header" />
			</item>
			
			<item type="text" name="tokenSourceQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition>
						<equals name="tokenSource" value="CUSTOM_url"/>
					</condition>
				</conditions>
			    <property name="policy.token.source.queryParameter" />
			</item>
					
		</subsection>
		
		<subsection label="Elaborazione Token">
		
			<item type="checkbox" name="validazioneJwtStato" label="Validazione JWT" defaultSelected="false" reloadOnChange="true">
				<conditions>
					<condition and="false">
						<equals name="tokenType" value="jws"/>
						<equals name="tokenType" value="jwe"/>
					</condition>
				</conditions>
				<property name="policy.validazioneJWT.stato" />
			</item>
			<item type="hidden" name="validazioneJwtSaveErrorInCache" value="false">
				<conditions>
					<condition and="false">
						<selected name="validazioneJwtStato" />
					</condition>
				</conditions>
				<property name="policy.validazioneJWT.saveErrorInCache"/>
			</item>
			
			<item type="checkbox" name="introspectionStato" label="Token Introspection" defaultSelected="false" reloadOnChange="true">
				<property name="policy.introspection.stato" />
			</item>			
			<item type="hidden" name="introspectionSaveErrorInCache" value="false">
				<conditions>
					<condition and="false">
						<selected name="introspectionStato" />
					</condition>
				</conditions>
				<property name="policy.introspection.saveErrorInCache"/>
			</item>
			
			<item type="checkbox" name="userInfoStato" label="OIDC - UserInfo" defaultSelected="false" reloadOnChange="true">
				<property name="policy.userInfo.stato" />
			</item>
			<item type="hidden" name="userInfoSaveErrorInCache" value="false">
				<conditions>
					<condition and="false">
						<selected name="userInfoStato" />
					</condition>
				</conditions>
				<property name="policy.userInfo.saveErrorInCache"/>
			</item>
			
			<item type="checkbox" name="tokenForwardStato" label="Token Forward" defaultSelected="false" reloadOnChange="true">
				<property name="policy.tokenForward.stato" />
			</item>
			
		</subsection>
		
		<subsection label="Endpoint Token">

			<conditions>
				<condition and="false">
					<selected name="introspectionStato"/>
					<selected name="userInfoStato" />
				</condition>
			</conditions>

			<item type="number" name="endpointConnectionTimeout" label="Connection Timeout" required="true" default="5000" min="1">
				<property name="connectionTimeout" properties="endpointConfig" />
			</item>
			<item type="number" name="endpointReadTimeout" label="Read Timeout" required="true" default="10000" min="1">
				<property name="readConnectionTimeout" properties="endpointConfig" />
			</item>
		
			<item type="checkbox" name="endpointHttps" label="Https" defaultSelected="false" reloadOnChange="true">
				<property name="policy.endpoint.https.stato" />
			</item>	
			
			<item type="checkbox" name="endpointProxy" label="Proxy" defaultSelected="false" reloadOnChange="true">
				<property name="policy.endpoint.proxy.stato" />
			</item>	
			
		</subsection>
				
	</section>

	<section label="Validazione JWT">
		
		<conditions>
			<condition and="true">
				<selected name="validazioneJwtStato"/>
			</condition>
		</conditions>
		
		<item type="select" name="validazioneJWTParserType" label="Formato Token" default="OIDC_ID_TOKEN" reloadOnChange="true">
			<values>
				<value value="JSON_WEB_TOKEN_RFC_7519" label="RFC 7519 - JSON Web Token "/>
				<value value="JSON_WEB_TOKEN_FOR_OAUTH2_ACCESS_TOKENS_RFC_9068" label="RFC 9068 - JSON Web Token (OAuth2 Access Token) "/>
				<!-- <value value="INTROSPECTION_RESPONSE_RFC_7662" label="RFC 7662 - Introspection"/> -->
				<value value="OIDC_ID_TOKEN" label="OpenID Connect - ID Token"/>
				<value value="GOOGLE" label="Google - ID Token"/>
				<value value="MAPPING" label="Personalizzato"/>
				<value value="CUSTOM" label="Plugin"/>
			</values>
			<property name="policy.validazioneJWT.claimsParser" />
		</item>

		<item type="text" name="validazioneJwtParserCustom" label="ClassName" required="true">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="CUSTOM"/>
				</condition>
			</conditions>
		   	<property name="policy.validazioneJWT.claimsParser.className" />
		</item>

		<item type="text" name="validazioneJwtIssuer" label="Issuer" required="true" default="iss">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.issuer" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtSubject" label="Subject" required="true" default="sub">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.subject" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtAudience" label="Audience" required="true" default="aud">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.audience" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtExpire" label="Expire" required="true" default="exp">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.expire" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtIssuedAt" label="IssuedAt" required="true" default="iat">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.issuedAt" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtNotToBeUsedBefore" label="NotToBeUsedBefore" required="true" default="nbf">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.notToBeUsedBefore" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtIdentifier" label="Identifier" required="true" default="jti">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.jwtIdentifier" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtClientId" label="ClientId" required="true" default="azp,client_id">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.clientId" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtUsername" label="Username" required="true" default="preferred_username,username,name">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.username" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtScope" label="Scope" required="true" default="scope">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.scope" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtRole" label="Role" required="true" default="role">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.role" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtFullName" label="User - Full name" required="true" default="name">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.user.fullName" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtFirstName" label="User - First name" required="true" default="given_name">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.user.firstName" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtMiddleName" label="User - Middle name" required="true" default="middle_name">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.user.middleName" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtFamilyName" label="User - Family name" required="true" default="family_name,last_name">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.user.familyName" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		<item type="text" name="validazioneJwtEMail" label="User - eMail" required="true" default="email,e-mail,e_mail,mail" note="Per ogni campo possono essere indicati più claims, separandoli con la virgola.&lt;BR/>Nel token verranno cercati nell'ordine in cui sono definiti.&lt;BR/>L'indicazione di un nome non è vincolante rispetto alla presenza all'interno del token.">
			<conditions>
				<condition and="true">
					<equals name="validazioneJWTParserType" value="MAPPING"/>
				</condition>
			</conditions>
	      		<property name="token.parser.user.eMail" properties="validazioneJwtTokenParserPropRefId" />
		</item>
		
		<subsection label="TrustStore">

			<conditions>
				<condition and="true">
					<equals name="tokenType" value="jws"/>
					<equals not="true" name="validazioneJWTParserType" value="GOOGLE"/>
				</condition>
			</conditions>

			<item type="select" name="validazioneJwtTruststoreType" label="Tipo" default="jks" reloadOnChange="true">
				<property name="rs.security.keystore.type" properties="signatureVerificationPropRefId" />
			</item>
			<item type="textarea" name="validazioneJwtTruststoreFile" label="File" required="true">
			    <property name="rs.security.keystore.file" properties="signatureVerificationPropRefId" />
			</item>
			<item type="text" name="validazioneJwtTruststorePassword" label="Password" required="true">
				<conditions>
					<condition not="true" and="true">
						<equals name="validazioneJwtTruststoreType" value="jwk"/>
					</condition>
				</conditions>
		      	<property name="rs.security.keystore.password" properties="signatureVerificationPropRefId" />
			</item>
			<item type="text" name="validazioneJwtTruststoreCertificateAlias" label="Alias Certificato" required="true">
			    <property name="rs.security.keystore.alias" properties="signatureVerificationPropRefId" />
			</item>

		</subsection>
		
		<subsection label="TrustStoreGoogle" hidden="true">

			<conditions>
				<condition and="true">
					<equals name="tokenType" value="jws"/>
					<equals name="validazioneJWTParserType" value="GOOGLE"/>
				</condition>
			</conditions>

			<item type="hidden" name="validazioneJwtTruststoreTypeGoogle" value="jwk">
				<property name="rs.security.keystore.type" properties="signatureVerificationPropRefId" />
			</item>
			<item type="hidden" name="validazioneJwtTruststoreFileGoogle" value="https://www.googleapis.com/oauth2/v3/certs">
			    <property name="rs.security.keystore.file" properties="signatureVerificationPropRefId" />
			</item>
			<item type="hidden" name="validazioneJwtTruststoreCertificateAliasGoogle" value="*">
			    <property name="rs.security.keystore.alias" properties="signatureVerificationPropRefId" />
			</item>
			<item type="hidden" name="validazioneJwtTruststoreTypeGoogleSSL" value="jks">
				<property name="rs.security.keystore.type.ssl" properties="signatureVerificationPropRefId" />
			</item>
			<item type="hidden" name="validazioneJwtTruststoreFileGoogleSSL" value="/Token.jks">
			    <property name="rs.security.keystore.file.ssl" properties="signatureVerificationPropRefId" />
			</item>
			<item type="hidden" name="validazioneJwtTruststorePasswordGoogleSSL" value="123456">
			    <property name="rs.security.keystore.password.ssl" properties="signatureVerificationPropRefId" />
			</item>

		</subsection>

		<subsection label="KeyStore">
		
			<conditions>
				<condition and="true">
					<equals name="tokenType" value="jwe"/>
				</condition>
			</conditions>

			<item type="select" name="encryptionKeyAlgorithm" label="Key Algorithm">
				<property name="rs.security.encryption.key.algorithm" properties="decryptionPropRefId" />
			</item>
			<item type="select" name="encryptionContentAlgorithm" label="Content Algorithm">
				<property name="rs.security.encryption.content.algorithm" properties="decryptionPropRefId" />
			</item>

			<item type="select" name="validazioneJwtKeystoreType" label="Tipo" default="jks" reloadOnChange="true">
				<property name="rs.security.keystore.type" properties="decryptionPropRefId" />
			</item>
			<item type="textarea" name="validazioneJwtKeystoreFile" label="File" required="true">
			    <property name="rs.security.keystore.file" properties="decryptionPropRefId" />
			</item>
			<item type="text" name="validazioneJwtKeystorePassword" label="Password" required="true">
				<conditions>
					<condition not="true" and="true">
						<equals name="validazioneJwtKeystoreType" value="jwk"/>
					</condition>
				</conditions>
		      	<property name="rs.security.keystore.password" properties="decryptionPropRefId" />
			</item>
			<item type="text" name="validazioneJwtKeystorePrivateKeyAlias" label="Alias Chiave Privata" required="true">
			    <property name="rs.security.keystore.alias" properties="decryptionPropRefId" />
			</item>
			<item type="text" name="validazioneJwtKeystorePrivateKeyPassword" label="Password Chiave Privata" required="true">
			    <property name="rs.security.key.password" properties="decryptionPropRefId" />
			</item>

		</subsection>

	</section>
		
		
	<section label="Token Introspection">
		
		<conditions>
			<condition and="true">
				<selected name="introspectionStato"/>
			</condition>
		</conditions>

		<item type="select" name="introspectionType" label="Tipo" default="INTROSPECTION_RFC_7662" reloadOnChange="true">
			<values>
				<value value="INTROSPECTION_RFC_7662" label="RFC 7662 - Introspection"/>
				<value value="GOOGLE" label="Google - TokenInfo"/>
				<value value="CUSTOM" label="Personalizzato"/>
			</values>
			<property name="policy.introspection.tipo" />
		</item>

		<item type="textarea" name="introspectionEndpointURLGoogle" label="URL" required="true" default="https://www.googleapis.com/oauth2/v3/tokeninfo">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.endpoint.url" />
		</item>
		<item type="textarea" name="introspectionEndpointURL" label="URL" required="true" default="http://">
			<conditions>
				<condition not="true" and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.endpoint.url" />
		</item>

		<item type="checkbox" name="introspectionEndpointBasic" label="Autenticazione Http Basic" defaultSelected="false" reloadOnChange="true">
			<!--  non si puo' verificare una condizione successiva. Comunque selezionando basic, sparisce bearer.
			<conditions>
				<condition not="true" and="true">
					<selected name="introspectionEndpointBearer"/>
				</condition>
			</conditions>
			-->
			<conditions>
				<condition not="true" and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.endpoint.basic.stato" />
		</item>
		<item type="checkbox" name="introspectionEndpointBearer" label="Autenticazione Bearer" defaultSelected="false" reloadOnChange="true">
			<conditions and="true">
				<condition not="true" and="true">
					<selected name="introspectionEndpointBasic"/>
				</condition>
				<condition not="true" and="true">
					<equals name="introspectionRequestPositionToken" value="authorization"/>
				</condition>
				<condition not="true" and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.endpoint.bearer.stato" />
		</item>
		<item type="checkbox" name="introspectionEndpointHttps" label="Autenticazione Https" defaultSelected="false" reloadOnChange="true">
			<conditions>
				<condition not="true" and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.endpoint.https.stato" />
		</item>
				
		<item type="hidden" name="introspectionHttpMethodRFC7662" value="POST">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="INTROSPECTION_RFC_7662"/>
				</condition>
			</conditions>
			<property name="policy.introspection.httpMethod" />
		</item>
		<item type="hidden" name="introspectionHttpMethodGoogle" value="GET">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.httpMethod" />
		</item>

		<item type="hidden" name="introspectionRequestPositionTokenRFC7662" value="form">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="INTROSPECTION_RFC_7662"/>
				</condition>
			</conditions>
			<property name="policy.introspection.requestTokenPosition" />
		</item>
		<item type="hidden" name="introspectionRequestPositionTokenFormParameterRFC7662" value="token">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="INTROSPECTION_RFC_7662"/>
				</condition>
			</conditions>
			<property name="policy.introspection.requestTokenPosition.formParameter" />
		</item>
		<item type="hidden" name="introspectionRequestPositionTokenGoogle" value="url">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.requestTokenPosition" />
		</item>
		<item type="hidden" name="introspectionRequestPositionTokenUrlParameterGoogle" value="access_token">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.requestTokenPosition.queryParameter" />
		</item>

		<item type="hidden" name="introspectionParserTypeRFC7662" value="INTROSPECTION_RESPONSE_RFC_7662">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="INTROSPECTION_RFC_7662"/>
				</condition>
			</conditions>
			<property name="policy.introspection.claimsParser" />
		</item>
		<item type="hidden" name="introspectionParserTypeGoogle" value="GOOGLE">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.introspection.claimsParser" />
		</item>

		<subsection label="Autenticazione Http Basic">
			<conditions>
				<condition and="true">
					<selected name="introspectionEndpointBasic"/>
				</condition>
			</conditions>
			<item type="text" name="introspectionEndpointBasicUsername" label="Username" required="true">
			      	<property name="policy.introspection.endpoint.basic.username" />
			</item>
			<item type="text" name="introspectionEndpointPassword" label="Password" required="true">
			      	<property name="policy.introspection.endpoint.basic.password" />
			</item>
		</subsection>
		
		<subsection label="Autenticazione Bearer">
			<conditions>
				<condition and="true">
					<selected name="introspectionEndpointBearer"/>
				</condition>
			</conditions>
			<item type="textarea" name="introspectionEndpointBearerToken" label="Token" required="true">
			      	<property name="policy.introspection.endpoint.bearer.token" />
			</item>
		</subsection>

		<subsection label="Configurazione Richiesta">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="CUSTOM"/>
				</condition>
			</conditions>

			<item type="select" name="introspectionHttpMethod" label="Http Method" reloadOnChange="true">
				<property name="policy.introspection.httpMethod" />
			</item>
		
			<item type="select" name="introspectionRequestPositionToken" label="Posizione Token" default="url" reloadOnChange="true">
				<values>
					<value value="authorization" label="HTTP Authorization Bearer"/>
					<value value="header" label="Header HTTP"/>
					<value value="url" label="Parametro URL"/>
					<value value="form" label="Parametro Form-Encoded Body"/>
				</values>
				<property name="policy.introspection.requestTokenPosition" />
			</item>
			<item type="text" name="introspectionRequestPositionTokenHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition>
						<equals name="introspectionRequestPositionToken" value="header"/>
					</condition>
				</conditions>
			    <property name="policy.introspection.requestTokenPosition.header" />
			</item>
			<item type="text" name="introspectionRequestPositionTokenQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition>
						<equals name="introspectionRequestPositionToken" value="url"/>
					</condition>
				</conditions>
			    <property name="policy.introspection.requestTokenPosition.queryParameter" />
			</item>
			<item type="text" name="introspectionRequestPositionTokenFormParameter" label="Nome Parametro Form" required="true">
				<conditions>
					<condition>
						<equals name="introspectionRequestPositionToken" value="form"/>
					</condition>
				</conditions>
			    <property name="policy.introspection.requestTokenPosition.formParameter" />
			</item>
		
			<item type="text" name="introspectionContentType" label="Content Type" required="true">
				<conditions and="true">
					<condition and="false">
						<equals name="introspectionHttpMethod" value="POST"/>
						<equals name="introspectionHttpMethod" value="PUT"/>
						<equals name="introspectionHttpMethod" value="PATCH"/>
						<equals name="introspectionHttpMethod" value="LINK"/>
						<equals name="introspectionHttpMethod" value="UNLINK"/>
					</condition>
					<condition not="true" and="true">
						<equals name="introspectionRequestPositionToken" value="form"/>
					</condition>
				</conditions>
			    <property name="policy.introspection.contentType" />
			</item>
		</subsection>

		<subsection label="Formato Risposta">
			<conditions>
				<condition and="true">
					<equals name="introspectionType" value="CUSTOM"/>
				</condition>
			</conditions>

			<item type="select" name="introspectionParserType" label="Tipo" default="MAPPING" reloadOnChange="true">
				<values>
					<!-- <value value="JSON_WEB_TOKEN_RFC_7519" label="RFC 7519 - JSON Web Token "/> -->
					<!-- <value value="JSON_WEB_TOKEN_FOR_OAUTH2_ACCESS_TOKENS_RFC_9068" label="RFC 9068 - JSON Web Token (OAuth2 Access Token) "/> -->
					<value value="INTROSPECTION_RESPONSE_RFC_7662" label="RFC 7662 - Introspection"/>
					<!-- <value value="OIDC_ID_TOKEN" label="OpenID Connect - ID Token"/> -->
					<value value="GOOGLE" label="Google - TokenInfo"/>
					<value value="MAPPING" label="Personalizzato"/>
					<value value="CUSTOM" label="Plugin"/>
				</values>
				<property name="policy.introspection.claimsParser" />
			</item>

			<item type="text" name="introspectionParserCustom" label="ClassName" required="true">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="CUSTOM"/>
					</condition>
				</conditions>
			   	<property name="policy.introspection.claimsParser.className" />
			</item>

			<item type="text" name="introspectionIssuer" label="Issuer" required="true" default="iss">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.issuer" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionSubject" label="Subject" required="true" default="sub">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.subject" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionAudience" label="Audience" required="true" default="aud">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.audience" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionExpire" label="Expire" required="true" default="exp">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.expire" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionIssuedAt" label="IssuedAt" required="true" default="iat">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.issuedAt" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionNotToBeUsedBefore" label="NotToBeUsedBefore" required="true" default="nbf">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.notToBeUsedBefore" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionIdentifier" label="Identifier" required="true" default="jti">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.jwtIdentifier" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionClientId" label="ClientId" required="true" default="client_id,azp">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.clientId" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionUsername" label="Username" required="true" default="preferred_username,username,name">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.username" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionScope" label="Scope" required="true" default="scope">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.scope" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionRole" label="Role" required="true" default="role">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.role" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionFullName" label="User - Full name" required="true" default="name">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.fullName" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionFirstName" label="User - First name" required="true" default="given_name">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.firstName" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionMiddleName" label="User - Middle name" required="true" default="middle_name">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.middleName" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionFamilyName" label="User - Family name" required="true" default="family_name,last_name">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.familyName" properties="introspectionTokenParserPropRefId" />
			</item>
			<item type="text" name="introspectionEMail" label="User - eMail" required="true" default="email,e-mail,e_mail,mail" note="Per ogni campo possono essere indicati più claims, separandoli con la virgola.&lt;BR/>Nel token verranno cercati nell'ordine in cui sono definiti.&lt;BR/>L'indicazione di un nome non è vincolante rispetto alla presenza all'interno del token.">
				<conditions>
					<condition and="true">
						<equals name="introspectionParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.eMail" properties="introspectionTokenParserPropRefId" />
			</item>
		</subsection>
		
	</section>
	
	<section label="OIDC - UserInfo">
				
		<conditions>
			<condition and="true">
				<selected name="userInfoStato"/>
			</condition>
		</conditions>
	
	
		<item type="select" name="userInfoType" label="Tipo" default="OIDC_USER_INFO" reloadOnChange="true">
			<values>
				<value value="OIDC_USER_INFO" label="OpenID Connect - UserInfo"/>
				<value value="GOOGLE" label="Google - UserInfo"/>
				<value value="CUSTOM" label="Personalizzato"/>
			</values>
			<property name="policy.userInfo.tipo" />
		</item>
		
		<item type="textarea" name="userInfoEndpointURLGoogle" label="URL" required="true" default="https://www.googleapis.com/oauth2/v3/userinfo">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
		    <property name="policy.userInfo.endpoint.url" />
		</item>
		<item type="textarea" name="userInfoEndpointURL" label="URL" required="true" default="http://">
			<conditions>
				<condition not="true" and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
		    <property name="policy.userInfo.endpoint.url" />
		</item>

		<item type="checkbox" name="userInfoEndpointBasic" label="Autenticazione Http" defaultSelected="false" reloadOnChange="true">
			<!--  non si puo' verificare una condizione successiva. Comunque selezionando basic, sparisce bearer.
			<conditions>
				<condition not="true" and="true">
					<selected name="userInfoEndpointBearer"/>
				</condition>
			</conditions>
			-->
			<conditions>
				<condition not="true" and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.endpoint.basic.stato" />
		</item>
		<item type="checkbox" name="userInfoEndpointBearer" label="Autenticazione Bearer" defaultSelected="false" reloadOnChange="true">
			<conditions and="true">
				<condition not="true" and="true">
					<selected name="userInfoEndpointBasic"/>
				</condition>
				<condition not="true" and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.endpoint.bearer.stato" />
		</item>
		<item type="checkbox" name="userInfoEndpointHttps" label="Autenticazione Https" defaultSelected="false" reloadOnChange="true">
			<conditions>
				<condition not="true" and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.endpoint.https.stato" />
		</item>
				
		<item type="hidden" name="userInfoHttpMethodOIDCUserInfo" value="GET">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="OIDC_USER_INFO"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.httpMethod" />
		</item>
		<item type="hidden" name="userInfoHttpMethodGoogle" value="GET">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.httpMethod" />
		</item>

		<item type="hidden" name="userInfoRequestPositionTokenOIDCUserInfo" value="authorization">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="OIDC_USER_INFO"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.requestTokenPosition" />
		</item>
		<item type="hidden" name="userInfoRequestPositionTokenGoogle" value="url">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.requestTokenPosition" />
		</item>
		<item type="hidden" name="userInfoRequestPositionTokenQueryParameterGoogle" value="access_token">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.requestTokenPosition.queryParameter" />
		</item>

		<item type="hidden" name="userInfoParserTypeOIDCUserInfo" value="OIDC_ID_TOKEN">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="OIDC_USER_INFO"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.claimsParser" />
		</item>
		<item type="hidden" name="userInfoParserTypeGoogle" value="GOOGLE">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="GOOGLE"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.claimsParser" />
		</item>

		<subsection label="Autenticazione Http">
			<conditions>
				<condition and="true">
					<selected name="userInfoEndpointBasic"/>
				</condition>
			</conditions>
			<item type="text" name="userInfoEndpointBasicUsername" label="Username" required="true">
			      	<property name="policy.userInfo.endpoint.basic.username" />
			</item>
			<item type="text" name="userInfoEndpointPassword" label="Password" required="true">
			      	<property name="policy.userInfo.endpoint.basic.password" />
			</item>
		</subsection>
		
		<subsection label="Autenticazione Bearer">
			<conditions and="true">
				<condition and="true">
					<selected name="userInfoEndpointBearer"/>
				</condition>
				<condition not="true" and="true">
					<equals name="userInfoRequestPositionToken" value="authorization"/>
				</condition>
			</conditions>
			<item type="textarea" name="userInfoEndpointBearerToken" label="Token" required="true">
			      	<property name="policy.userInfo.endpoint.bearer.token" />
			</item>
		</subsection>

		<subsection label="Configurazione Richiesta">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="CUSTOM"/>
				</condition>
			</conditions>

			<item type="select" name="userInfoHttpMethod" label="Http Method" reloadOnChange="true">
				<property name="policy.userInfo.httpMethod" />
			</item>
		
			<item type="select" name="userInfoRequestPositionToken" label="Posizione Token" default="url" reloadOnChange="true">
				<values>
					<value value="authorization" label="HTTP Authorization Bearer"/>
					<value value="header" label="Header HTTP"/>
					<value value="url" label="Parametro URL"/>
					<value value="form" label="Parametro Form-Encoded Body"/>
				</values>
				<property name="policy.userInfo.requestTokenPosition" />
			</item>
			<item type="text" name="userInfoRequestPositionTokenHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition>
						<equals name="userInfoRequestPositionToken" value="header"/>
					</condition>
				</conditions>
			    <property name="policy.userInfo.requestTokenPosition.header" />
			</item>
			<item type="text" name="userInfoRequestPositionTokenQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition>
						<equals name="userInfoRequestPositionToken" value="url"/>
					</condition>
				</conditions>
			    <property name="policy.userInfo.requestTokenPosition.queryParameter" />
			</item>
			<item type="text" name="userInfoRequestPositionTokenFormParameter" label="Nome Parametro Form" required="true">
				<conditions>
					<condition>
						<equals name="userInfoRequestPositionToken" value="form"/>
					</condition>
				</conditions>
			    <property name="policy.userInfo.requestTokenPosition.formParameter" />
			</item>
		
			<item type="text" name="userInfoContentType" label="Content Type" required="true">
				<conditions and="true">
					<condition and="false">
						<equals name="userInfoHttpMethod" value="POST"/>
						<equals name="userInfoHttpMethod" value="PUT"/>
						<equals name="userInfoHttpMethod" value="PATCH"/>
						<equals name="userInfoHttpMethod" value="LINK"/>
						<equals name="userInfoHttpMethod" value="UNLINK"/>
					</condition>
					<condition not="true" and="true">
						<equals name="userInfoRequestPositionToken" value="form"/>
					</condition>
				</conditions>
			    <property name="policy.userInfo.contentType" />
			</item>
		</subsection>
	
		<subsection label="Formato Risposta">
			<conditions>
				<condition and="true">
					<equals name="userInfoType" value="CUSTOM"/>
				</condition>
			</conditions>

			<item type="select" name="userInfoParserType" label="Tipo" default="MAPPING" reloadOnChange="true">
				<values>
					<!-- <value value="JSON_WEB_TOKEN_RFC_7519" label="RFC 7519 - JSON Web Token "/> -->
					<!-- <value value="JSON_WEB_TOKEN_FOR_OAUTH2_ACCESS_TOKENS_RFC_9068" label="RFC 9068 - JSON Web Token (OAuth2 Access Token) "/> -->
					<!-- <value value="INTROSPECTION_RESPONSE_RFC_7662" label="RFC 7662 - Introspection"/> -->
					<value value="OIDC_ID_TOKEN" label="OpenID Connect"/> 
					<value value="MAPPING" label="Personalizzato"/>
					<value value="CUSTOM" label="Plugin"/>
				</values>
				<property name="policy.userInfo.claimsParser" />
			</item>

			<item type="text" name="userInfoParserCustom" label="ClassName" required="true">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="CUSTOM"/>
					</condition>
				</conditions>
			   	<property name="policy.userInfo.claimsParser.className" />
			</item>

			<item type="text" name="userInfoIssuer" label="Issuer" required="true" default="iss">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.issuer" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoSubject" label="Subject" required="true" default="sub">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.subject" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoAudience" label="Audience" required="true" default="aud">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.audience" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoExpire" label="Expire" required="true" default="exp">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.expire" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoIssuedAt" label="IssuedAt" required="true" default="iat">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.issuedAt" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoNotToBeUsedBefore" label="NotToBeUsedBefore" required="true" default="nbf">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.notToBeUsedBefore" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoIdentifier" label="Identifier" required="true" default="jti">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.jwtIdentifier" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoClientId" label="ClientId" required="true" default="azp,client_id">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.clientId" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoUsername" label="Username" required="true" default="preferred_username,username,name">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.username" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoScope" label="Scope" required="true" default="scope">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.scope" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoRole" label="Role" required="true" default="role">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.role" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoFullName" label="User - Full name" required="true" default="name">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.fullName" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoFirstName" label="User - First name" required="true" default="given_name">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.firstName" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoMiddleName" label="User - Middle name" required="true" default="middle_name">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.middleName" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoFamilyName" label="User - Family name" required="true" default="family_name,last_name">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.familyName" properties="userInfoTokenParserPropRefId" />
			</item>
			<item type="text" name="userInfoEMail" label="User - eMail" required="true" default="email,e-mail,e_mail,mail" note="Per ogni campo possono essere indicati più claims, separandoli con la virgola.&lt;BR/>Nel token verranno cercati nell'ordine in cui sono definiti.&lt;BR/>L'indicazione di un nome non è vincolante rispetto alla presenza all'interno del token.">
				<conditions>
					<condition and="true">
						<equals name="userInfoParserType" value="MAPPING"/>
					</condition>
				</conditions>
		      		<property name="token.parser.user.eMail" properties="userInfoTokenParserPropRefId" />
			</item>
		</subsection>
	
	</section>
	
	<section label="Https">

		<conditions>
			<condition and="false">
				<selected name="endpointHttps"/>
				<selected name="introspectionEndpointHttps"/>
				<selected name="userInfoEndpointHttps"/>
			</condition>	
		</conditions>
	
		<item type="select" name="endpointHttpsTipologia" label="Tipologia">
			<property name="sslType" properties="sslConfig" />
		</item>
		<item type="checkbox" name="endpointHttpsHostNameVerifier" label="Hostname Verifier" defaultSelected="true" >
			<property name="hostnameVerifier" properties="sslConfig" />
		</item>
	
	
		<subsection label="Autenticazione Server">

			<item type="checkbox" name="endpointHttpsTrustAllCerts" label="Verifica" defaultSelected="true" reloadOnChange="true">
				<property name="trustAllCerts" properties="sslConfig" selectedValue="false" unselectedValue="true"/>
			</item>
	
			<item type="select" name="endpointHttpsTruststoreType" label="Tipo" default="jks" reloadOnChange="true">
				<conditions>
					<condition and="false">
						<selected name="endpointHttpsTrustAllCerts"/>
					</condition>	
				</conditions>
				<property name="trustStoreType" properties="sslConfig" />
			</item>
			<item type="textarea" name="endpointHttpsTruststoreFile" label="File" required="true">
				<conditions>
					<condition and="false">
						<selected name="endpointHttpsTrustAllCerts"/>
					</condition>	
				</conditions>
				<property name="trustStoreLocation" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsTruststorePassword" label="Password" required="true">
			      	<conditions>
					<condition and="false">
						<selected name="endpointHttpsTrustAllCerts"/>
					</condition>	
				</conditions>
				<property name="trustStorePassword" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsTruststoreAlgoritmo" label="Algoritmo" default="PKIX" required="true">
			      	<conditions>
					<condition and="false">
						<selected name="endpointHttpsTrustAllCerts"/>
					</condition>	
				</conditions>
				<property name="trustManagementAlgorithm" properties="sslConfig" />
			</item>
			<item type="textarea" name="endpointHttpsTrustStoreCRLs" label="CRL File(s)" required="false" note="Elencare più file separandoli con la ','">
			      	<conditions>
					<condition and="false">
						<selected name="endpointHttpsTrustAllCerts"/>
					</condition>	
				</conditions>
				<property name="trustStoreCRLs" properties="sslConfig" />
			</item>
			
		</subsection>
		
		<subsection label="Autenticazione Client">
		
			<conditions>
				<condition and="false">
					<selected name="introspectionEndpointHttps"/>
					<selected name="userInfoEndpointHttps"/>
				</condition>
			</conditions>
			
			<item type="select" name="endpointHttpsClientMode" label="Dati Accesso al KeyStore" default="default" reloadOnChange="true">
				<values>
					<value value="default" label="Usa valore del TrustStore"/>
					<value value="ridefinito" label="Ridefinisci"/>
				</values>
				<property name="policy.endpoint.ssl.mode" />
			</item>
			<item type="select" name="endpointHttpsClientKeystoreType" label="Tipo" default="jks" reloadOnChange="true">
				<conditions>
					<condition and="true">
						<equals name="endpointHttpsClientMode" value="ridefinito"/>
					</condition>
				</conditions>
				<property name="keyStoreType" properties="sslClientConfig" />
			</item>
			<item type="textarea" name="endpointHttpsClientKeystoreFile" label="File" required="true">
				<conditions>
					<condition and="true">
						<equals name="endpointHttpsClientMode" value="ridefinito"/>
					</condition>
				</conditions>
			    <property name="keyStoreLocation" properties="sslClientConfig" />
			</item>
			<item type="text" name="endpointHttpsClientKeystorePassword" label="Password" required="true">
				<conditions>
					<condition and="true">
						<equals name="endpointHttpsClientMode" value="ridefinito"/>
					</condition>
				</conditions>
			    <property name="keyStorePassword" properties="sslClientConfig" />
			</item>
			<item type="text" name="endpointHttpsClientPasswordChiavePrivata" label="Password Chiave Privata" required="true">
				<property name="keyPassword" properties="sslClientConfig" />
			</item>
			<item type="text" name="endpointHttpsClientAliasChiavePrivata" label="Alias Chiave Privata" required="false">
				<property name="keyAlias" properties="sslClientConfig" />
			</item>
			<item type="text" name="endpointHttpsClientAlgoritmo" label="Algoritmo" default="SunX509" required="true">
				<property name="keyManagementAlgorithm" properties="sslClientConfig" />
			</item>
		
		</subsection>
		
	</section>
	
	<section hidden="true" label="Https GOOGLE">

		<conditions>
			<condition and="false">
				<equals name="introspectionType" value="GOOGLE"/>
				<equals name="userInfoType" value="GOOGLE"/>
			</condition>
			<condition not="true" and="false">
				<selected name="endpointHttps"/>
				<selected name="introspectionEndpointHttps"/>
				<selected name="userInfoEndpointHttps"/>
			</condition>
		</conditions>
	
		<item type="hidden" name="endpointHttpsGOOGLE" value="true">
			<property name="policy.endpoint.https.stato" />
		</item>	
		<item type="hidden" name="endpointHttpsTipologiaGOOGLE" value="TLSv1.2">
			<property name="sslType" properties="sslConfig" />
		</item>
		<item type="hidden" name="endpointHttpsHostNameVerifierGOOGLE" value="true" >
			<property name="hostnameVerifier" properties="sslConfig" />
		</item>
	
		<subsection hidden="true"  label="Autenticazione Server GOOGLE">
	
			<item type="hidden" name="endpointHttpsTruststoreTypeGOOGLE" value="jks">
				<property name="trustStoreType" properties="sslConfig" />
			</item>
			<item type="hidden" name="endpointHttpsTruststoreFileGOOGLE" value="/Token.jks">
			    <property name="trustStoreLocation" properties="sslConfig" />
			</item>
			<item type="hidden" name="endpointHttpsTruststorePasswordGOOGLE" value="123456">
			      	<property name="trustStorePassword" properties="sslConfig" />
			</item>
			<item type="hidden" name="endpointHttpsTruststoreAlgoritmoGOOGLE" value="PKIX">
			      	<property name="trustManagementAlgorithm" properties="sslConfig" />
			</item>
			
		</subsection>
		
	</section>
			
	<section label="Proxy">
	
		<conditions>
			<condition and="true">
				<selected name="endpointProxy"/>
			</condition>
		</conditions>
	
		<item type="hidden" name="endpointProxyType" value="http">
			<property name="proxyType" properties="endpointConfig" />
		</item>
		<item type="text" name="endpointProxyHostname" label="Hostname" required="true">
			<property name="proxyHostname" properties="endpointConfig" />
		</item>
		<item type="number" name="endpointProxyPort" label="Porta" required="true" min="1" max="65535">
			<property name="proxyPort" properties="endpointConfig" />
		</item>
		<item type="text" name="endpointProxyUsername" label="Username" required="false">
			<property name="proxyUsername" properties="endpointConfig" />
		</item>
		<item type="text" name="endpointProxyPassword" label="Password" required="false">
			<property name="proxyPassword" properties="endpointConfig" />
		</item>
		
	</section>

	
	<section label="Token Forward">
				
		<conditions>
			<condition and="true">
				<selected name="tokenForwardStato"/>
			</condition>
		</conditions>
		
		<item type="checkbox" name="tokenForwardTrasparente" label="Originale" defaultSelected="false" reloadOnChange="true">
			<property name="policy.tokenForward.trasparente.stato" />
		</item>
		<item type="checkbox" name="tokenForwardInfoRaccolte" label="Informazioni Raccolte" defaultSelected="false" reloadOnChange="true">
			<conditions>
				<condition and="false">
					<selected name="validazioneJwtStato"/>
					<selected name="introspectionStato"/>
					<selected name="userInfoStato"/>
				</condition>
			</conditions>
			<property name="policy.tokenForward.infoRaccolte.stato" />
		</item>
		
		<subsection label="Originale">

			<conditions>
				<condition and="true">
					<selected name="tokenForwardTrasparente" />
				</condition>
			</conditions>

			<item type="select" name="tokenForwardTrasparenteMode" label="Modalità" default="asReceived" reloadOnChange="true">
				<conditions>
					<condition not="true" and="true">
						<equals name="tokenSource" value="RFC6750_form" />
					</condition>
				</conditions>
				<values>
					<value value="asReceived" label="Come è stato ricevuto"/>
					<value value="RFC6750_header" label="RFC 6750 - Bearer Token Usage (Authorization Request Header Field)"/>
					<value value="RFC6750_url" label="RFC 6750 - Bearer Token Usage (URI Query Parameter)"/>
					<value value="CUSTOM_header" label="Header HTTP"/>
					<value value="CUSTOM_url" label="Parametro URL"/>
				</values>
				<property name="policy.tokenForward.trasparente.mode" />
			</item>
			
			<item type="text" name="tokenForwardTrasparenteModeSourceHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition>
						<equals name="tokenForwardTrasparenteMode" value="CUSTOM_header"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.trasparente.mode.header" />
			</item>
			
			<item type="text" name="tokenForwardTrasparenteModeSourceQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition>
						<equals name="tokenForwardTrasparenteMode" value="CUSTOM_url"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.trasparente.mode.queryParameter" />
			</item>
			
		</subsection>
		
		<subsection label="Informazioni Raccolte">
		
			<conditions>
				<condition and="true">
					<selected name="tokenForwardInfoRaccolte" />
				</condition>
			</conditions>
	
			<item type="select" name="tokenForwardInfoRaccolteMode" label="Modalità" default="op2header" reloadOnChange="true">
				<values>
					<value value="op2header" label="GovWay Headers"/>
					<value value="op2json" label="GovWay JSON"/>
					<value value="op2jws" label="GovWay JWS"/>
					<value value="jws" label="JWS"/>
					<value value="jwe" label="JWE"/>
					<value value="json" label="JSON"/>
				</values>
				<property name="policy.tokenForward.infoRaccolte.mode" />
			</item>
			
			<item type="checkbox" name="tokenForwardInfoRaccolteModeBase64" label="Base64 Encoded" defaultSelected="true">
				<conditions and="true">
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="op2json"/>
						<equals name="tokenForwardInfoRaccolteMode" value="json"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.base64" />
			</item>

			<item type="select" name="tokenForwardInfoRaccolteModeJWSSignature" label="Signature Algorithm" >
				<conditions and="true">
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="op2jws"/>
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
					</condition>
				</conditions>
				<property name="rs.security.signature.algorithm" properties="signaturePropRefId" />
			</item>
			
			<item type="select" name="tokenForwardInfoRaccolteModeJWEKeyAlgorithm" label="Key Algorithm" >
				<conditions and="true">
					<condition and="true">
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
					</condition>
				</conditions>
				<property name="rs.security.encryption.key.algorithm" properties="encryptionPropRefId" />
			</item>
			<item type="select" name="tokenForwardInfoRaccolteModeJWEContentAlgorithm" label="Content Algorithm" >
				<conditions and="true">
					<condition and="true">
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
					</condition>
				</conditions>
				<property name="rs.security.encryption.content.algorithm" properties="encryptionPropRefId" />
			</item>
			
			<item type="hidden" name="tokenForwardInfoRaccolteScelta" value="true">
				<!-- La scelta deve essere 'true' se almeno due funzioni insieme sono abilitate -->
				<conditions and="false">
					<condition and="true">
						<selected name="validazioneJwtStato"/>
						<selected name="introspectionStato"/>
					</condition>
					<condition and="true">
						<selected name="validazioneJwtStato"/>
						<selected name="userInfoStato"/>
					</condition>
					<condition and="true">
						<selected name="introspectionStato"/>
						<selected name="userInfoStato"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.scelta" />
			</item>
			
			<item type="hidden" name="tokenForwardInfoRaccolteNoSceltaValidazioneJWT" value="true">
				<conditions and="true">
					<condition and="true">
						<selected name="validazioneJwtStato"/>
						<equals not="true" name="tokenForwardInfoRaccolteScelta" value="true"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.validazioneJWT.tmp" />
			</item>	
			<item type="hidden" name="tokenForwardInfoRaccolteSceltaValidazioneJWT" value="true">
				<conditions and="false">
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteScelta"/>
						<equals name="tokenForwardInfoRaccolteScelta" value="true"/>
					</condition>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteNoSceltaValidazioneJWT"/>
						<equals name="tokenForwardInfoRaccolteNoSceltaValidazioneJWT" value="true"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.validazioneJWT.tmp2" />
			</item>		
			<item type="checkbox" name="tokenForwardInfoRaccolteModeValidazioneJWT" label="Validazione JWT" defaultSelected="true" reloadOnChange="true">
				<conditions and="true">
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteSceltaValidazioneJWT"/>
						<equals name="tokenForwardInfoRaccolteSceltaValidazioneJWT" value="true"/>
					</condition>
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
						<equals name="tokenForwardInfoRaccolteMode" value="json"/>
					</condition>
					<condition and="true">
						<selected name="validazioneJwtStato"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.validazioneJWT" />
			</item>
			
			<item type="hidden" name="tokenForwardInfoRaccolteNoSceltaIntrospection" value="true">
				<conditions and="true">
					<condition and="true">
						<selected name="introspectionStato"/>
						<equals not="true" name="tokenForwardInfoRaccolteScelta" value="true"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.introspection.tmp" />
			</item>	
			<item type="hidden" name="tokenForwardInfoRaccolteSceltaIntrospection" value="true">
				<conditions and="false">
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteScelta"/>
						<equals name="tokenForwardInfoRaccolteScelta" value="true"/>
					</condition>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteNoSceltaIntrospection"/>
						<equals name="tokenForwardInfoRaccolteNoSceltaIntrospection" value="true"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.validazioneJWT.tmp2" />
			</item>	
			<item type="checkbox" name="tokenForwardInfoRaccolteModeIntrospection" label="Introspection" defaultSelected="true" reloadOnChange="true">
				<conditions and="true">
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteSceltaIntrospection"/>
						<equals name="tokenForwardInfoRaccolteSceltaIntrospection" value="true"/>
					</condition>
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
						<equals name="tokenForwardInfoRaccolteMode" value="json"/>
					</condition>
					<condition and="true">
						<selected name="introspectionStato"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.introspection" />
			</item>
			
			<item type="hidden" name="tokenForwardInfoRaccolteNoSceltaUserInfo" value="true">
				<conditions and="true">
					<condition and="true">
						<selected name="userInfoStato"/>
						<equals not="true" name="tokenForwardInfoRaccolteScelta" value="true"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.UserInfo.tmp" />
			</item>	
			<item type="hidden" name="tokenForwardInfoRaccolteSceltaUserInfo" value="true">
				<conditions and="false">
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteScelta"/>
						<equals name="tokenForwardInfoRaccolteScelta" value="true"/>
					</condition>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteNoSceltaUserInfo"/>
						<equals name="tokenForwardInfoRaccolteNoSceltaUserInfo" value="true"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.validazioneJWT.tmp2" />
			</item>	
			<item type="checkbox" name="tokenForwardInfoRaccolteModeUserInfo" label="UserInfo" defaultSelected="true" reloadOnChange="true">
				<conditions and="true">
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteSceltaUserInfo"/>
						<equals name="tokenForwardInfoRaccolteSceltaUserInfo" value="true"/>
					</condition>
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
						<equals name="tokenForwardInfoRaccolteMode" value="json"/>
					</condition>
					<condition and="true">
						<selected name="userInfoStato"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.userInfo" />
			</item>

		</subsection>
		
		<subsection label="Informazioni Raccolte Validazione JWT">
			<conditions and="true">
				<condition and="true">
					<selected name="tokenForwardInfoRaccolteModeValidazioneJWT" />
				</condition>
			</conditions>
			
			<item type="select" name="tokenForwardInfoRaccolteModeValidazioneJWT_tipoConsegna" label="Consegna" default="CUSTOM_header" reloadOnChange="true">
				<conditions and="false">
					<condition and="true">
						<selected name="tokenForwardInfoRaccolteModeValidazioneJWT" />
					</condition>
				</conditions>
				<values>
					<value value="CUSTOM_header" label="Header HTTP"/>
					<value value="CUSTOM_url" label="Parametro URL"/>
				</values>
				<property name="policy.tokenForward.infoRaccolte.validazioneJWT.mode" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeValidazioneJWT_tipoConsegnaHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteModeValidazioneJWT_tipoConsegna"/>
						<equals name="tokenForwardInfoRaccolteModeValidazioneJWT_tipoConsegna" value="CUSTOM_header"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.infoRaccolte.validazioneJWT.mode.header" />
			</item>	
			<item type="text" name="tokenForwardInfoRaccolteModeValidazioneJWT_tipoConsegnaQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteModeValidazioneJWT_tipoConsegna"/>
						<equals name="tokenForwardInfoRaccolteModeValidazioneJWT_tipoConsegna" value="CUSTOM_url"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.infoRaccolte.validazioneJWT.mode.queryParameter" />
			</item>
			
		</subsection>
		
		<subsection label="Informazioni Raccolte Introspection">
			<conditions and="true">
				<condition and="true">
					<selected name="tokenForwardInfoRaccolteModeIntrospection" />
				</condition>
			</conditions>
			
			<item type="select" name="tokenForwardInfoRaccolteModeIntrospection_tipoConsegna" label="Consegna" default="CUSTOM_header" reloadOnChange="true">
				<conditions and="false">
					<condition and="true">
						<selected name="tokenForwardInfoRaccolteModeIntrospection" />
					</condition>
				</conditions>
				<values>
					<value value="CUSTOM_header" label="Header HTTP"/>
					<value value="CUSTOM_url" label="Parametro URL"/>
				</values>
				<property name="policy.tokenForward.infoRaccolte.introspection.mode" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeIntrospection_tipoConsegnaHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteModeIntrospection_tipoConsegna"/>
						<equals name="tokenForwardInfoRaccolteModeIntrospection_tipoConsegna" value="CUSTOM_header"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.infoRaccolte.introspection.mode.header" />
			</item>	
			<item type="text" name="tokenForwardInfoRaccolteModeIntrospection_tipoConsegnaQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteModeIntrospection_tipoConsegna"/>
						<equals name="tokenForwardInfoRaccolteModeIntrospection_tipoConsegna" value="CUSTOM_url"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.infoRaccolte.introspection.mode.queryParameter" />
			</item>
				
		</subsection>
		
		<subsection label="Informazioni Raccolte UserInfo">
			<conditions and="true">
				<condition and="true">
					<selected name="tokenForwardInfoRaccolteModeUserInfo" />
				</condition>
			</conditions>
			
			<item type="select" name="tokenForwardInfoRaccolteModeUserInfo_tipoConsegna" label="Consegna" default="CUSTOM_header" reloadOnChange="true">
				<conditions and="false">
					<condition and="true">
						<selected name="tokenForwardInfoRaccolteModeUserInfo" />
					</condition>
				</conditions>
				<values>
					<value value="CUSTOM_header" label="Header HTTP"/>
					<value value="CUSTOM_url" label="Parametro URL"/>
				</values>
				<property name="policy.tokenForward.infoRaccolte.userInfo.mode" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeUserInfo_tipoConsegnaHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteModeUserInfo_tipoConsegna"/>
						<equals name="tokenForwardInfoRaccolteModeUserInfo_tipoConsegna" value="CUSTOM_header"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.infoRaccolte.userInfo.mode.header" />
			</item>	
			<item type="text" name="tokenForwardInfoRaccolteModeUserInfo_tipoConsegnaQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition and="true">
						<defined name="tokenForwardInfoRaccolteModeUserInfo_tipoConsegna"/>
						<equals name="tokenForwardInfoRaccolteModeUserInfo_tipoConsegna" value="CUSTOM_url"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.infoRaccolte.userInfo.mode.queryParameter" />
			</item>
			
		</subsection>
		
		<subsection label="JWS KeyStore">

			<conditions and="true">
				<condition and="false">
					<equals name="tokenForwardInfoRaccolteMode" value="op2jws"/>
					<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
				</condition>
			</conditions>

			<item type="select" name="tokenForwardInfoRaccolteModeJWSKeystoreType" label="Tipo" default="jks" reloadOnChange="true">
				<property name="rs.security.keystore.type" properties="signaturePropRefId" />
			</item>
			<item type="textarea" name="tokenForwardInfoRaccolteModeJWSKeystoreFile" label="File" required="true">
			     <property name="rs.security.keystore.file" properties="signaturePropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWSKeystorePassword" label="Password" required="true">
				<conditions>
					<condition not="true" and="true">
						<equals name="tokenForwardInfoRaccolteModeJWSKeystoreType" value="jwk"/>
					</condition>
				</conditions>
		      	<property name="rs.security.keystore.password" properties="signaturePropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWSKeystorePrivateKeyAlias" label="Alias Chiave Privata" required="true">
			    <property name="rs.security.keystore.alias" properties="signaturePropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWSKeystorePrivateKeyPassword" label="Password Chiave Privata" required="true">
			    <property name="rs.security.key.password" properties="signaturePropRefId" />
			</item>

		</subsection>
		
		<subsection label="JWE KeyStore">

			<conditions and="true">
				<condition and="true">
					<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
				</condition>
			</conditions>

			<item type="select" name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" label="Tipo" default="jks" reloadOnChange="true">
				<property name="rs.security.keystore.type" properties="encryptionPropRefId" />
			</item>
			<item type="textarea" name="tokenForwardInfoRaccolteModeJWEContentKeystoreFile" label="File" required="true">
			    <property name="rs.security.keystore.file" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystorePassword" label="Password" required="true">
				<conditions>
					<condition not="true" and="true">
						<equals name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" value="jwk"/>
					</condition>
				</conditions>
			    <property name="rs.security.keystore.password" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystoreCertificateAlias" label="Alias Certificato" required="true">
				<conditions>
					<condition not="true">
						<equals name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" value="jceks"/>
					</condition>
				</conditions>
			    <property name="rs.security.keystore.alias" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystorePrivateKeyAlias" label="Alias Chiave Privata" required="true">
				<conditions>
					<condition not="false">
						<equals name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" value="jceks"/>
					</condition>
				</conditions>
			    <property name="rs.security.keystore.alias" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystorePrivateKeyPassword" label="Password Chiave Privata" required="true">
				<conditions>
					<condition not="false">
						<equals name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" value="jceks"/>
					</condition>
				</conditions>
			    <property name="rs.security.key.password" properties="encryptionPropRefId" />
			</item>

		</subsection>
		
	</section>

</config>



