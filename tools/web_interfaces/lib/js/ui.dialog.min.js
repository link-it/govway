!function(e){var i={dragStart:"start.draggable",drag:"drag.draggable",dragStop:"stop.draggable",maxHeight:"maxHeight.resizable",minHeight:"minHeight.resizable",maxWidth:"maxWidth.resizable",minWidth:"minWidth.resizable",resizeStart:"start.resizable",resize:"drag.resizable",resizeStop:"stop.resizable"};e.widget("ui.dialog",{_init:function(){this.originalTitle=this.element.attr("title");var i=this,t=this.options,o=t.title||this.originalTitle||"&nbsp;",s=e.ui.dialog.getTitleId(this.element),a=(this.uiDialog=e("<div/>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+t.dialogClass).css({position:"absolute",overflow:"hidden",zIndex:t.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(o){t.closeOnEscape&&o.keyCode&&o.keyCode==e.ui.keyCode.ESCAPE&&i.close(o)}).attr({role:"dialog","aria-labelledby":s}).mousedown(function(e){i.moveToTop(e)}),n=(this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(a),(this.uiDialogTitlebar=e("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(a)),r=e('<a href="#"/>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){r.addClass("ui-state-hover")},function(){r.removeClass("ui-state-hover")}).focus(function(){r.addClass("ui-state-focus")}).blur(function(){r.removeClass("ui-state-focus")}).mousedown(function(e){e.stopPropagation()}).click(function(e){return i.close(e),!1}).appendTo(n);(this.uiDialogTitlebarCloseText=e("<span/>")).addClass("ui-icon ui-icon-closethick").text(t.closeText).appendTo(r),e("<span/>").addClass("ui-dialog-title").attr("id",s).html(o).prependTo(n);n.find("*").add(n).disableSelection(),t.draggable&&e.fn.draggable&&this._makeDraggable(),t.resizable&&e.fn.resizable&&this._makeResizable(),this._createButtons(t.buttons),this._isOpen=!1,t.bgiframe&&e.fn.bgiframe&&a.bgiframe(),t.autoOpen&&this.open()},destroy:function(){this.overlay&&this.overlay.destroy(),this.shadow&&this._destroyShadow(),this.uiDialog.hide(),this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle)},close:function(i){!1!==this._trigger("beforeclose",i)&&(this.overlay&&this.overlay.destroy(),this.shadow&&this._destroyShadow(),this.uiDialog.hide(this.options.hide).unbind("keypress.ui-dialog"),this._trigger("close",i),e.ui.dialog.overlay.resize(),this._isOpen=!1)},isOpen:function(){return this._isOpen},moveToTop:function(i,t){if(this.options.modal&&!i||!this.options.stack&&!this.options.modal)return this._trigger("focus",t);var o=this.options.zIndex,s=this.options;e(".ui-dialog:visible").each(function(){o=Math.max(o,Number.parseInt(e(this).css("z-index"),10)||s.zIndex)}),this.overlay&&this.overlay.$el.css("z-index",++o),this.shadow&&this.shadow.css("z-index",++o);var a={scrollTop:this.element.attr("scrollTop"),scrollLeft:this.element.attr("scrollLeft")};this.uiDialog.css("z-index",++o),this.element.attr(a),this._trigger("focus",t)},open:function(i){if(!this._isOpen){var t=this.options,o=this.uiDialog;this.overlay=t.modal?new e.ui.dialog.overlay(this):null,o.next().length&&o.appendTo("body"),this._size(),this._position(t.position),o.show(t.show),this.moveToTop(!0,i),t.modal&&o.bind("keypress.ui-dialog",function(i){if(i.keyCode==e.ui.keyCode.TAB){var t=e(":tabbable",this),o=t.filter(":first")[0],s=t.filter(":last")[0];i.target!=s||i.shiftKey?i.target==o&&i.shiftKey&&setTimeout(function(){s.focus()},1):setTimeout(function(){o.focus()},1)}}),e([]).add(o.find(".ui-dialog-content :tabbable:first")).add(o.find(".ui-dialog-buttonpane :tabbable:first")).add(o.find(".ui-dialog-titlebar :tabbable:first")).filter(":first").focus(),t.shadow&&this._createShadow(),this._trigger("open",i),this._isOpen=!0}},_createButtons:function(i){var t=this,o=!1,s=e("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiDialog.find(".ui-dialog-buttonpane").remove(),"object"==typeof i&&null!==i&&e.each(i,function(){return!(o=!0)}),o&&(e.each(i,function(i,o){e('<button type="button"></button>').addClass("ui-state-default ui-corner-all").text(i).click(function(){o.apply(t.element[0],arguments)}).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}).focus(function(){e(this).addClass("ui-state-focus")}).blur(function(){e(this).removeClass("ui-state-focus")}).appendTo(s)}),s.appendTo(this.uiDialog))},_makeDraggable:function(){var i=this,t=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content",helper:t.dragHelper,handle:".ui-dialog-titlebar",containment:"document",start:function(){t.dragStart&&t.dragStart.apply(i.element[0],arguments),e.browser.msie&&e.browser.version<7&&i.shadow&&i.shadow.hide()},drag:function(){t.drag&&t.drag.apply(i.element[0],arguments),i._refreshShadow(1)},stop:function(){t.dragStop&&t.dragStop.apply(i.element[0],arguments),e.ui.dialog.overlay.resize(),e.browser.msie&&e.browser.version<7&&i.shadow&&i.shadow.show(),i._refreshShadow()}})},_makeResizable:function(i){i=void 0===i?this.options.resizable:i;var t=this,o=this.options,s="string"==typeof i?i:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",alsoResize:this.element,helper:o.resizeHelper,maxWidth:o.maxWidth,maxHeight:o.maxHeight,minWidth:o.minWidth,minHeight:o.minHeight,start:function(){o.resizeStart&&o.resizeStart.apply(t.element[0],arguments),e.browser.msie&&e.browser.version<7&&t.shadow&&t.shadow.hide()},resize:function(){o.resize&&o.resize.apply(t.element[0],arguments),t._refreshShadow(1)},handles:s,stop:function(){o.resizeStop&&o.resizeStop.apply(t.element[0],arguments),e.ui.dialog.overlay.resize(),e.browser.msie&&e.browser.version<7&&t.shadow&&t.shadow.show(),t._refreshShadow()}}).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_position:function(i){var t=e(window),o=e(document),s=o.scrollTop(),a=o.scrollLeft(),n=s;if(e.inArray(i,["center","top","right","bottom","left"])>=0&&(i=["right"==i||"left"==i?i:"center","top"==i||"bottom"==i?i:"middle"]),i.constructor!=Array&&(i=["center","middle"]),i[0].constructor==Number)a+=i[0];else switch(i[0]){case"left":a+=0;break;case"right":a+=t.width()-this.uiDialog.outerWidth();break;default:a+=(t.width()-this.uiDialog.outerWidth())/2}if(i[1].constructor==Number)s+=i[1];else switch(i[1]){case"top":s+=0;break;case"bottom":s+=t.height()-this.uiDialog.outerHeight();break;default:s+=(t.height()-this.uiDialog.outerHeight())/2}s=Math.max(s,n),this.uiDialog.css({top:s,left:a})},_setData:function(t,o){switch(i[t]&&this.uiDialog.data(i[t],o),t){case"buttons":this._createButtons(o);break;case"closeText":this.uiDialogTitlebarCloseText.text(o);break;case"draggable":o?this._makeDraggable():this.uiDialog.draggable("destroy");break;case"height":this.uiDialog.height(o);break;case"position":this._position(o);break;case"resizable":var s=this.uiDialog,a=this.uiDialog.is(":data(resizable)");a&&!o&&s.resizable("destroy"),a&&"string"==typeof o&&s.resizable("option","handles",o),a||this._makeResizable(o);break;case"title":e(".ui-dialog-title",this.uiDialogTitlebar).html(o||"&nbsp;");break;case"width":this.uiDialog.width(o)}e.widget.prototype._setData.apply(this,arguments)},_size:function(){var e=this.options;this.element.css({height:0,minHeight:0,width:"auto"});var i=this.uiDialog.css({height:"auto",width:e.width}).height();this.element.css({minHeight:Math.max(e.minHeight-i,0),height:"auto"==e.height?"auto":e.height-i})},_createShadow:function(){return this.shadow=e('<div class="ui-widget-shadow"></div>').css("position","absolute").appendTo(document.body),this._refreshShadow(),this.shadow},_refreshShadow:function(i){if(!(i&&e.browser.msie&&e.browser.version<7)){var t=this.uiDialog.offset();this.shadow.css({left:t.left,top:t.top,width:this.uiDialog.outerWidth(),height:this.uiDialog.outerHeight()})}},_destroyShadow:function(){this.shadow.remove(),this.shadow=null}}),e.extend(e.ui.dialog,{version:"1.6rc6",defaults:{autoOpen:!0,bgiframe:!1,buttons:{},closeOnEscape:!0,closeText:"close",draggable:!0,height:"auto",minHeight:150,minWidth:150,modal:!1,position:"center",resizable:!0,shadow:!0,stack:!0,title:"",width:300,zIndex:1e3},getter:"isOpen",uuid:0,getTitleId:function(e){return"ui-dialog-title-"+(e.attr("id")||++this.uuid)},overlay:function(i){this.$el=e.ui.dialog.overlay.create(i)}}),e.extend(e.ui.dialog.overlay,{instances:[],events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".dialog-overlay"}).join(" "),create:function(i){0===this.instances.length&&(setTimeout(function(){e("a, :input").bind(e.ui.dialog.overlay.events,function(){var i=!1,t=e(this).parents(".ui-dialog");if(t.length){var o=e(".ui-dialog-overlay");if(o.length){var s=Number.parseInt(o.css("z-index"),10);o.each(function(){s=Math.max(s,Number.parseInt(e(this).css("z-index"),10))}),i=Number.parseInt(t.css("z-index"),10)>s}else i=!0}return i})},1),e(document).bind("keydown.dialog-overlay",function(t){i.options.closeOnEscape&&t.keyCode&&t.keyCode==e.ui.keyCode.ESCAPE&&i.close(t)}),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var t=e("<div></div>").appendTo(document.body).addClass("ui-widget-overlay").css({width:this.width(),height:this.height()});return i.options.bgiframe&&e.fn.bgiframe&&t.bgiframe(),this.instances.push(t),t},destroy:function(i){this.instances.splice(e.inArray(this.instances,i),1),0===this.instances.length&&e("a, :input").add([document,window]).unbind(".dialog-overlay"),i.remove()},height:function(){if(e.browser.msie&&e.browser.version<7){var i=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);return i<Math.max(document.documentElement.offsetHeight,document.body.offsetHeight)?e(window).height()+"px":i+"px"}return e(document).height()+"px"},width:function(){if(e.browser.msie&&e.browser.version<7){var i=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);return i<Math.max(document.documentElement.offsetWidth,document.body.offsetWidth)?e(window).width()+"px":i+"px"}return e(document).width()+"px"},resize:function(){var i=e([]);e.each(e.ui.dialog.overlay.instances,function(){i=i.add(this)}),i.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}}),e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery);