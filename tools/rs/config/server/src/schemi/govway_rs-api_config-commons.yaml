openapi: 3.0.0
components:
  parameters:
   
    # Dati Identificativi nel path
    id_soggetto_autorizzato:
      name: soggetto_autorizzato
      in: path
      description: Nome del soggetto autorizzato
      required: true
      schema:
        $ref: 'govway_core.yaml#/components/schemas/SimpleName'
    id_applicativo_autorizzato:
      name: applicativo_autorizzato
      in: path
      description: Nome dell'applicativo autorizzato
      required: true
      schema:
        $ref: 'govway_core.yaml#/components/schemas/NCName'
    id_ruolo_autorizzato:
      name: ruolo_autorizzato
      in: path
      description: Nome del ruolo autorizzato
      required: true
      schema:
        $ref: 'govway_core.yaml#/components/schemas/NCName'
    id_scope_autorizzato:
      name: scope_autorizzato
      in: path
      description: Nome dello scope autorizzato
      required: true
      schema:
        $ref: 'govway_core.yaml#/components/schemas/NCName'
    id_policy:
      name: id_policy
      in: path
      description: Identificativo della policy di Rate Limiting
      required: true
      schema:
        $ref: 'govway_core.yaml#/components/schemas/NCName'
    elemento_correlazione_applicativa:
      name: elemento
      in: path
      description: Elemento della regola di correlazione applicativa
      required: true
      schema:
        type: string
        maxLength: 255
    
    # Dati Identificativi nella query
    id_soggetto_applicativo:
      name: soggetto_applicativo
      in: query
      description: Nome del soggetto proprietario dell'applicativo
      required: false
      schema:
        $ref: 'govway_core.yaml#/components/schemas/SimpleName'
              
    # Ricerche
    tipo_api:
      name: tipo_api
      in: query
      description: Indica il tipo di API
      required: false
      example: 'rest'
      schema:
        $ref: '#/components/schemas/TipoApiEnum'
    dominio:
      name: dominio
      in: query
      description: Indica il dominio di un soggetto
      required: false
      example: 'esterno'
      schema:
        $ref: '#/components/schemas/DominioEnum'
    ruolo:
      name: ruolo
      in: query
      description: Identifica un ruolo
      required: false
      example: 'AccessoSolaLettura'
      schema:
        $ref: 'govway_core.yaml#/components/schemas/NCName'
    fonte:
      name: fonte
      in: query
      description: Indica la fonte di un oggetto
      required: false
      example: 'esterna'
      schema:
        $ref: '#/components/schemas/FonteEnum'
    contesto:
      name: contesto
      in: query
      description: Indica il contesto di utilizzo di un oggetto
      required: false
      example: 'erogazione'
      schema:
        $ref: '#/components/schemas/ContestoEnum'
    http_method:
      name: http_method
      in: query
      description: Indica il tipo di http method
      required: false
      example: 'PUT'
      schema:
        $ref: '#/components/schemas/HttpMethodEnum'
    azione:
      name: azione
      in: query
      description: Identifica un azione o risorsa
      required: false
      example: 'Azione1'
      schema:
        $ref: 'govway_core.yaml#/components/schemas/NCName'
    metrica:
      name: metrica
      in: query
      description: Identifica una metrica di Rate Limiting
      required: false
      example: 'numero-richieste'
      schema:
        $ref: '#/components/schemas/RateLimitingCriteriMetricaEnum'
        
  schemas:
 
    # Base: Stato
    StatoApiDescrizione:
      type: string
      example: 'Nessuna risorsa definita nella API'
      
    # Base: API
    ApiBase:
      type: object
      required:
        - tipo_interfaccia
        - nome
        - versione
      properties:
        referente:
          $ref: 'govway_core.yaml#/components/schemas/SimpleName'
        tipo_interfaccia:
          type: object
          oneOf:
            - $ref: '#/components/schemas/ApiInterfacciaRest'
            - $ref: '#/components/schemas/ApiInterfacciaSoap'
          discriminator:
            propertyName: protocollo
            mapping:
              'rest': '#/components/schemas/ApiInterfacciaRest'
              'soap': '#/components/schemas/ApiInterfacciaSoap'
        nome:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
        descrizione:
          type: string
          maxLength: 255
          example: 'descrizione API'
        versione:
          $ref: 'govway_core.yaml#/components/schemas/Versione'
        tags:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/NCName'
          example: [PagamentiTelematici, Anagrafica] 

    ApiBaseConSoggetto:
      type: object
      allOf:
        - $ref: 'govway_rs-api_config-commons.yaml#/components/schemas/ApiBase'
        - type: object
          required:
            - profilo
            - soggetto
          properties:
            profilo:
               $ref: 'govway_core.yaml#/components/schemas/ProfiloEnum'
            soggetto: 
               $ref: 'govway_core.yaml#/components/schemas/SimpleName'

    ApiInterfacciaRest:
      type: object
      required:
        - protocollo
        - formato
      properties:
        protocollo:
          $ref: '#/components/schemas/TipoApiEnum'
        formato:
          $ref: '#/components/schemas/FormatoRestEnum'
    ApiInterfacciaSoap:
      type: object
      required:
        - protocollo
        - formato
      properties:
        protocollo:
          $ref: '#/components/schemas/TipoApiEnum'
        formato:
          $ref: '#/components/schemas/FormatoSoapEnum'
                      
    # Base: Credenziali
    AuthenticationHttpBasic:
      type: object
      required:
        - modalita_accesso
        - username
      properties:
        modalita_accesso:
          $ref: '#/components/schemas/ModalitaAccessoEnum'
        username:
          type: string
          maxLength: 255
          example: 'user'
        password:
          type: string
          format: password
          maxLength: 255
          example: 'pwd'
      additionalProperties: false   
    AuthenticationHttps:
      type: object
      required:
         - modalita_accesso
         - certificato
      properties:
        modalita_accesso:
          $ref: '#/components/schemas/ModalitaAccessoEnum'
        certificato:
          type: object
          oneOf:
            - $ref: '#/components/schemas/AuthenticationHttpsCertificato'
            - $ref: '#/components/schemas/AuthenticationHttpsConfigurazioneManuale'
          discriminator:
            propertyName: tipo
            mapping:
              'certificato': '#/components/schemas/AuthenticationHttpsCertificato'
              'configurazione-manuale': '#/components/schemas/AuthenticationHttpsConfigurazioneManuale' 
      additionalProperties: false
    AuthenticationHttpsCertificato:
      type: object
      required:
        - tipo
        - archivio
        - tipo_certificato
      properties:
        tipo: 
          $ref: '#/components/schemas/TipoAutenticazioneHttps'   
        archivio:
          type: string
          format: byte
        alias: 
          type: string
          maxLength: 255
          example: 'alias'
        password: 
          type: string
          maxLength: 255
          example: 'changeit'
        tipo_certificato: 
          $ref: '#/components/schemas/TipoKeystore'  
        strict_verification:
          type: boolean
          example: false
          default: false
      additionalProperties: false
    AuthenticationHttpsConfigurazioneManuale:
      type: object
      required:
        - tipo
        - subject
      properties:
        tipo: 
          $ref: '#/components/schemas/TipoAutenticazioneHttps'
        subject: 
          type: string
          maxLength: 2800
          example: 'cn=esterno'
        issuer: 
          type: string
          maxLength: 2800
          example: 'cn=esterno'
      additionalProperties: false
    AuthenticationPrincipal:
      type: object
      required:
       - modalita_accesso
       - userid
      properties:
        modalita_accesso:
          $ref: '#/components/schemas/ModalitaAccessoEnum'
        userid:
          type: string
          maxLength: 255
          example: 'idEsterno'
      additionalProperties: false
    BaseCredenziali:
      type: object
      properties:
        credenziali:
          type: object
          oneOf:
            - $ref: '#/components/schemas/AuthenticationHttpBasic'
            - $ref: '#/components/schemas/AuthenticationHttps'
            - $ref: '#/components/schemas/AuthenticationPrincipal'
          discriminator:
            propertyName: modalita_accesso
            mapping:
              'http-basic': '#/components/schemas/AuthenticationHttpBasic'
              'https': '#/components/schemas/AuthenticationHttps'
              'principal': '#/components/schemas/AuthenticationPrincipal'  

    # Base: Connettore 
    ConnettoreConfigurazioneHttpBasic:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          maxLength: 255
          example: 'user'
        password:
          type: string
          format: password
          maxLength: 255
          example: 'pwd'
      additionalProperties: false           
    ConnettoreConfigurazioneHttps:
      type: object
      required: 
        - tipologia
        - server
      properties:
        tipologia:
          $ref: '#/components/schemas/SslTipologiaEnum'
        hostname_verifier:
          type: boolean
          example: false
          default: true
        server:
          $ref: '#/components/schemas/ConnettoreConfigurazioneHttpsServer'
        client: 
          $ref: '#/components/schemas/ConnettoreConfigurazioneHttpsClient'
    ConnettoreConfigurazioneHttpsServer:
      type: object
      required: 
        - truststore_path
        - truststore_tipo
        - truststore_password
      properties:
        truststore_path:
          type: string
          maxLength: 255
          example: '/path/to/truststore'
        truststore_tipo:
          $ref: '#/components/schemas/KeystoreEnum'
        truststore_password:
          type: string
          format: password
          maxLength: 255
          example: 'pwd'
        truststore_crl:
          type: string
        algoritmo:
          type: string
          maxLength: 255
          example: 'PKIX'
          default: 'PKIX'
    ConnettoreConfigurazioneHttpsClient:
      type: object
      required: 
        - keystore_path
        - keystore_tipo
        - keystore_password
        - key_password
      properties:
        keystore_path:
          type: string
          maxLength: 255
          example: '/path/to/keystore'
        keystore_tipo:
          $ref: '#/components/schemas/KeystoreEnum'
        keystore_password:
          type: string
          format: password
          maxLength: 255
          example: 'pwd'
        key_password:
          type: string
          format: password
          maxLength: 255
          description: password della chiave privata
          example: 'pwd'
        key_alias:
          type: string
          maxLength: 255
          description: alias della chiave privata
          example: 'pwd'
        algoritmo:
          type: string
          maxLength: 255
          example: 'SunX509'
          default: 'SunX509'
    ConnettoreConfigurazioneProxy:
      type: object
      required: 
        - hostname
        - porta
      properties:
        hostname:
          type: string
          format: hostname
          maxLength: 255
          example: 'proxy.ente.it'
        porta:
          type: integer
          format: int32
          minimum: 1
          maximum: 65535
          example: 8080
        username:
          type: string
          maxLength: 255
          example: 'user'
        password:
          type: string
          maxLength: 255
          format: password
          example: 'pwd'
    ConnettoreConfigurazioneTimeout:
      type: object
      required: 
        - connection_timeout
        - connection_read_timeout
        - tempo_medio_risposta
      properties:
        connection_timeout:
          type: integer
          format: int32
          example: 10000
          description: tempo massimo (in millisecondi) per instaurare una connessione
        connection_read_timeout:
          type: integer
          format: int32
          example: 150000
          description: tempo massimo (in millisecondi) per ricevere una risposta
        tempo_medio_risposta:
          type: integer
          format: int32
          example: 10000
          description: tempo medio (in millisecondi) atteso per ricevere una risposta
    Connettore:
      type: object
      required: 
        - endpoint
      properties:
        endpoint:
          type: string
          format: uri
          example: 'http://ente.it/servizio'
        autenticazione_http:
          $ref: '#/components/schemas/ConnettoreConfigurazioneHttpBasic'
        autenticazione_https:
          $ref: '#/components/schemas/ConnettoreConfigurazioneHttps'
        proxy:
          $ref: '#/components/schemas/ConnettoreConfigurazioneProxy'
        tempi_risposta:
          $ref: '#/components/schemas/ConnettoreConfigurazioneTimeout'
        token_policy:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
          
    # Base: Erogazione/Fruizione

    APIBaseImpl:
      type: object
      required:
        - api_nome
        - api_versione
      properties:
        api_nome:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
        api_versione:
          $ref: 'govway_core.yaml#/components/schemas/Versione'
        api_referente:
          $ref: 'govway_core.yaml#/components/schemas/SimpleName'
        api_soap_servizio:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
        api_tags:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/NCName'
          example: [PagamentiTelematici, Anagrafica] 
        tipo_servizio:
          $ref: 'govway_core.yaml#/components/schemas/Tipo'
          
    APIImpl:
      type: object
      allOf:
        - $ref: '#/components/schemas/APIBaseImpl'
        - type: object
          required:
            - connettore
          properties:
            autenticazione:
             type: object
             oneOf:
               - $ref: '#/components/schemas/APIImplAutenticazioneDisabilitata' 
               - $ref: '#/components/schemas/APIImplAutenticazioneBasic'
               - $ref: '#/components/schemas/APIImplAutenticazioneHttps'
               - $ref: '#/components/schemas/APIImplAutenticazionePrincipal'
             discriminator:
               propertyName: tipo
               mapping:
                 'disabilitato': '#/components/schemas/APIImplAutenticazioneDisabilitata'
                 'http-basic': '#/components/schemas/APIImplAutenticazioneBasic'
                 'https': '#/components/schemas/APIImplAutenticazioneHttps'
                 'principal': '#/components/schemas/APIImplAutenticazionePrincipal'
            autorizzazione:
             type: object
             oneOf:
               - $ref: '#/components/schemas/APIImplAutorizzazioneDisabilitata'
               - $ref: '#/components/schemas/APIImplAutorizzazioneAbilitataNew'
               - $ref: '#/components/schemas/APIImplAutorizzazioneXACML'
             discriminator:
               propertyName: tipo
               mapping:
                 'disabilitato': '#/components/schemas/APIImplAutorizzazioneDisabilitata'
                 'abilitato': '#/components/schemas/APIImplAutorizzazioneAbilitataNew'
                 'xacml-Policy': '#/components/schemas/APIImplAutorizzazioneXACML'
            connettore:
              $ref: '#/components/schemas/Connettore'

    APIImplAutenticazioneDisabilitata:
      type: object
      required:
        - tipo
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutenticazioneEnum'
      additionalProperties: false
      
    APIImplAutenticazioneBasic:
      type: object
      required:
        - tipo
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutenticazioneEnum'
        forward:
          type: boolean
          default: false
          example: false
        opzionale:
          type: boolean
          default: false
          example: false
      additionalProperties: false
      
    APIImplAutenticazioneHttps:
      type: object
      required:
        - tipo
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutenticazioneEnum'
        opzionale:
          type: boolean
          default: false
          example: false
      additionalProperties: false
      
    APIImplAutenticazionePrincipal:
      type: object
      required:
        - tipo
        - tipo_principal
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutenticazioneEnum'
        tipo_principal:
          $ref: '#/components/schemas/TipoAutenticazionePrincipal'
        token:
          $ref: '#/components/schemas/TipoAutenticazionePrincipalToken'
        nome:
          type: string
          description: |
            indica il nome dell'header http in caso di autenticazione principal 'header-based', 
            il nome del parametro della query nel caso di autenticazione principal 'form-based' o
            il nome del claim in caso di autenticazione principal 'token' con tipo di claim 'custom'
          maxLength: 255
        pattern:
          type: string
          example: indica l'espressione regolare da utilizzare in caso di autenticazione 'url-based'
        forward:
          type: boolean
          default: false
          example: false
        opzionale:
          type: boolean
          default: false
          example: false
      additionalProperties: false

    APIImplAutenticazioneCustom:
      type: object
      required:
        - tipo
        - nome
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutenticazioneEnum'
        nome:
          description: nome autenticazione 'custom', set tipo='custom'
          type: string
          maxLength: 255
        opzionale:
          type: boolean
          default: false
          example: false  
      additionalProperties: false 


    APIImplAutorizzazioneDisabilitata:
      type: object
      required:
        - tipo
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutorizzazioneEnum'
      additionalProperties: false
      
    APIImplAutorizzazioneAbilitataNew:
      type: object
      required:
        - tipo
        - richiedente
        - ruoli
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutorizzazioneEnum'
        richiedente:
          type: boolean
          default: true
          example: false
        soggetto:
          $ref: 'govway_core.yaml#/components/schemas/SimpleName'
        ruoli:
          type: boolean
          default: false
          example: false
        ruoli_fonte:
          $ref: '#/components/schemas/FonteEnum' 
        ruoli_richiesti:
          $ref: '#/components/schemas/AllAnyEnum'
        ruolo:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
      additionalProperties: false
    APIImplAutorizzazioneAbilitata:
      type: object
      required:
        - tipo
        - richiedente
        - ruoli
        - scope
        - token
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutorizzazioneEnum'
        richiedente:
          type: boolean
          default: true
          example: false
        ruoli:
          type: boolean
          default: false
          example: false
        ruoli_fonte:
          $ref: '#/components/schemas/FonteEnum' 
        ruoli_richiesti:
          $ref: '#/components/schemas/AllAnyEnum'
        scope:
          type: boolean
          default: false
          example: false
        scope_richiesti:
          $ref: '#/components/schemas/AllAnyEnum' 
        token:
          type: boolean
          default: false
          example: false
        token_claims:
          description: Indicare per riga i claims richiesti (nome=valore); è possibile elencare differenti valori ammissibili separandoli con la virgola
          type: string
          maxLength: 4000
      additionalProperties: false

    APIImplAutorizzazioneXACMLView:
      type: object
      required:
        - tipo
        - ruoli_fonte
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutorizzazioneEnum'
        ruoli_fonte:
          $ref: '#/components/schemas/FonteEnum'
      additionalProperties: false                 
    APIImplAutorizzazioneXACML:
      type: object
      required:
        - tipo
        - policy
        - ruoli_fonte
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutorizzazioneEnum'
        ruoli_fonte:
          $ref: '#/components/schemas/FonteEnum'
        policy:
          type: string
          format: byte
      additionalProperties: false 
      
    APIImplAutorizzazioneCustom:
      type: object
      required:
        - tipo
        - nome
      properties:
        tipo:
          $ref: '#/components/schemas/TipoAutorizzazioneEnum'
        nome:
          type: string
          maxLength: 255  
      additionalProperties: false 


    ApiImplItem:
      type: object
      allOf:
        - $ref: 'govway_core.yaml#/components/schemas/BaseSoggettoItem'
        - $ref: '#/components/schemas/APIBaseImpl'
        - type: object
          required:
            - nome
            - versione
            - stato
            - stato_descrizione
          properties:
            nome:
              $ref: 'govway_core.yaml#/components/schemas/NCName'
            versione:
              $ref: 'govway_core.yaml#/components/schemas/Versione'
            api_tipo:
              $ref: '#/components/schemas/TipoApiEnum'
            stato:
              $ref: '#/components/schemas/StatoApiEnum'
            stato_descrizione:
              $ref: '#/components/schemas/StatoApiDescrizione'    
                 
    ApiImplViewItem:
      type: object
      allOf:
        - $ref: '#/components/schemas/ApiImplItem'
        - type: object
          required:
            - url_invocazione
            - connettore
            - gestione_cors
          properties:
            url_invocazione:
              type: string
              format: uri
            connettore:
              type: string    
            gestione_cors:
              type: string 
          
    ApiImplInformazioniGenerali:
      type: object
      required:
        - nome
      properties:
        tipo:
          $ref: 'govway_core.yaml#/components/schemas/Tipo'
        nome:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
        api_soap_servizio:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
    ApiImplInformazioniGeneraliView:
      type: object
      allOf:
          - $ref: 'govway_core.yaml#/components/schemas/BaseItem'
          - $ref: '#/components/schemas/ApiImplInformazioniGenerali'
  
    ApiImplVersioneApi:
      type: object
      required:
        - api_versione
      properties:
        api_versione:
          $ref: 'govway_core.yaml#/components/schemas/Versione'
    ApiImplVersioneApiView:
      type: object
      allOf:
          - $ref: 'govway_core.yaml#/components/schemas/BaseSoggettoItem'
          - $ref: '#/components/schemas/APIBaseImpl'
          - type: object
            required:
              - versioni
            properties:
              versioni:
                type: array
                items:
                  $ref: 'govway_core.yaml#/components/schemas/Versione'
                example: [1, 2, 3] 

    ApiImplUrlInvocazione:
      type: object
      required:
        - modalita
      properties:
        modalita:
          $ref: '#/components/schemas/ModalitaIdentificazioneAzioneEnum'
        pattern:
            description: XPath/JsonPath nel caso di modalità 'content-based' o espressione regolare nel caso 'url-based'
            type: string
            maxLength: 255 
        nome:
            description: Nome dell'header http nel caso di modalità 'header-based'
            type: string
            maxLength: 255 
        force_interface:
            description: Indicazione se oltre alla modalità indicata per individuare l'azione viene usata comunque la modalità 'interface-based'
            type: boolean
            default: true 
    ApiImplUrlInvocazioneView:
      type: object
      allOf:
          - $ref: '#/components/schemas/ApiImplUrlInvocazione'      
          - type: object
            required:
              - url_invocazione
            properties:
               url_invocazione:
                  type: string
                  format: uri
               azioni:
                  type: array
                  items:
                    $ref: 'govway_core.yaml#/components/schemas/NCName'
                  example: ['az1', 'az2', 'az3']

    ApiImplAllegato:
      type: object
      required:
        - allegato
      properties:
        allegato:
          type: object
          oneOf:
            - $ref: '#/components/schemas/ApiImplAllegatoGenerico'
            - $ref: '#/components/schemas/ApiImplAllegatoSpecificaSemiformale'
            - $ref: '#/components/schemas/ApiImplAllegatoSpecificaSicurezza'
            - $ref: '#/components/schemas/ApiImplAllegatoSpecificaLivelloServizio'
          discriminator:
            propertyName: ruolo
            mapping:
              'allegato': '#/components/schemas/ApiImplAllegatoGenerico'
              'specificaSemiFormale': '#/components/schemas/ApiImplAllegatoSpecificaSemiformale'
              'specificaSicurezza': '#/components/schemas/ApiImplAllegatoSpecificaSicurezza'
              'specificaLivelloServizio': '#/components/schemas/ApiImplAllegatoSpecificaLivelloServizio'
    ApiImplAllegatoGenerico:
      type: object
      required:
        - nome
        - documento
        - ruolo
      properties:
        nome:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
        documento:
          type: string
          format: byte
        ruolo:
          $ref: '#/components/schemas/RuoloAllegatoAPIImpl'
    ApiImplAllegatoSpecificaSemiformale:
      type: object
      allOf:
        - $ref: '#/components/schemas/ApiImplAllegatoGenerico'
        - type: object
          required:
            - tipo_specifica
          properties:
           tipo_specifica:
             $ref: '#/components/schemas/TipoSpecificaSemiformaleEnum'
    ApiImplAllegatoSpecificaSicurezza:
      type: object
      allOf:
        - $ref: '#/components/schemas/ApiImplAllegatoGenerico'
        - type: object
          required:
            - tipo_specifica
          properties:
           tipo_specifica:
             $ref: '#/components/schemas/TipoSpecificaSicurezzaEnum'
    ApiImplAllegatoSpecificaLivelloServizio:
      type: object
      allOf:
        - $ref: '#/components/schemas/ApiImplAllegatoGenerico'
        - type: object
          required:
            - tipo_specifica
          properties:
           tipo_specifica:
             $ref: '#/components/schemas/TipoSpecificaLivelloServizioEnum'

    ApiImplAllegatoItem:
      type: object
      required:
        - allegato
      properties:
        allegato:
          type: object
          oneOf:
            - $ref: '#/components/schemas/ApiImplAllegatoItemGenerico'
            - $ref: '#/components/schemas/ApiImplAllegatoItemSpecificaSemiformale'
            - $ref: '#/components/schemas/ApiImplAllegatoItemSpecificaSicurezza'
            - $ref: '#/components/schemas/ApiImplAllegatoItemSpecificaLivelloServizio'
          discriminator:
            propertyName: ruolo
            mapping:
              'allegato': '#/components/schemas/ApiImplAllegatoItemGenerico'
              'specificaSemiFormale': '#/components/schemas/ApiImplAllegatoItemSpecificaSemiformale'
              'specificaSicurezza': '#/components/schemas/ApiImplAllegatoItemSpecificaSicurezza'
              'specificaLivelloServizio': '#/components/schemas/ApiImplAllegatoItemSpecificaLivelloServizio'
    ApiImplAllegatoItemGenerico:
      type: object
      required:
        - nome
        - ruolo
      properties:
        nome:
          $ref: 'govway_core.yaml#/components/schemas/NCName'            
        ruolo:
          $ref: '#/components/schemas/RuoloAllegatoAPIImpl'
    ApiImplAllegatoItemSpecificaSemiformale:
      type: object
      allOf:
        - $ref: '#/components/schemas/ApiImplAllegatoItemGenerico'
        - type: object
          required:
            - tipo_specifica
          properties:
           tipo_specifica:
             $ref: '#/components/schemas/TipoSpecificaSemiformaleEnum'
    ApiImplAllegatoItemSpecificaSicurezza:
      type: object
      allOf:
        - $ref: '#/components/schemas/ApiImplAllegatoItemGenerico'
        - type: object
          required:
            - tipo_specifica
          properties:
           tipo_specifica:
             $ref: '#/components/schemas/TipoSpecificaSicurezzaEnum'
    ApiImplAllegatoItemSpecificaLivelloServizio:
      type: object
      allOf:
        - $ref: '#/components/schemas/ApiImplAllegatoItemGenerico'
        - type: object
          required:
            - tipo_specifica
          properties:
           tipo_specifica:
             $ref: '#/components/schemas/TipoSpecificaLivelloServizioEnum'             

    ListaApiImplAllegati:
       type: object
       allOf:
          - $ref: 'govway_core.yaml#/components/schemas/Lista'
          - type: object
            required:
              - items
            properties:
              items:
                type: array
                items:
                  $ref: '#/components/schemas/ApiImplAllegatoItem'

    # Base: Gruppi Erogazione/Fruizione

    GruppoNome:
      type: object
      required:
        - nome
      properties:
        nome:
          type: string
          maxLength: 255
    GruppoAzioni:
      type: object
      required:
        - azioni
      properties:
        azioni:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/NCName'
          example: ['az1', 'az2', 'az3']
    GruppoBase:
      type: object
      allOf:
          - $ref: '#/components/schemas/GruppoNome'      
          - $ref: '#/components/schemas/GruppoAzioni'
    Gruppo:
      type: object
      allOf:
          - $ref: '#/components/schemas/GruppoBase'      
          - type: object
            properties:
              configurazione:
                type: object
                oneOf:
                  - $ref: '#/components/schemas/GruppoEreditaConfigurazione'
                  - $ref: '#/components/schemas/GruppoNuovaConfigurazione'
                discriminator:
                  propertyName: modalita
                  mapping:
                    'eredita': '#/components/schemas/GruppoEreditaConfigurazione'
                    'nuova': '#/components/schemas/GruppoNuovaConfigurazione'
    GruppoEreditaConfigurazione:
      type: object
      required:
       - modalita
       - nome
      properties:
        modalita:
          $ref: '#/components/schemas/ModalitaConfigurazioneGruppoEnum'
        nome:
          type: string
          maxLength: 255 
    GruppoNuovaConfigurazione:
      type: object
      required:
        - modalita
        - autenticazione
      properties:
         modalita:
            $ref: '#/components/schemas/ModalitaConfigurazioneGruppoEnum'
         autenticazione:
            type: object
            oneOf:
              - $ref: '#/components/schemas/APIImplAutenticazioneDisabilitata'             
              - $ref: '#/components/schemas/APIImplAutenticazioneBasic'
              - $ref: '#/components/schemas/APIImplAutenticazioneHttps'
              - $ref: '#/components/schemas/APIImplAutenticazionePrincipal'
            discriminator:
              propertyName: tipo
              mapping:
                'disabilitato': '#/components/schemas/APIImplAutenticazioneDisabilitata'
                'http-basic': '#/components/schemas/APIImplAutenticazioneBasic'
                'https': '#/components/schemas/APIImplAutenticazioneHttps'
                'principal': '#/components/schemas/APIImplAutenticazionePrincipal'             
    GruppoItem:
      type: object
      allOf:
          - $ref: '#/components/schemas/GruppoBase'      
          - type: object
            required:
              - predefinito
            properties:
              predefinito:
                type: boolean
    ListaGruppi:
       type: object
       allOf:
          - $ref: 'govway_core.yaml#/components/schemas/Lista'
          - type: object
            required:
              - items
            properties:
              items:
                type: array
                items:
                  $ref: '#/components/schemas/GruppoItem' 

    # Base: Configurazioni Erogazione/Fruizione

    GestioneCorsAccessControl:
      type: object
      required:
        - all_allow_origins
      properties:
        all_allow_origins:
          type: boolean
          default: true
        allow_origins:
          type: array
          items:
            type: string
            maxLength: 255
        allow_headers:
          type: array
          items:
            type: string
            maxLength: 255 
        allow_methods:
          type: array
          items:
            $ref: '#/components/schemas/HttpMethodEnum'   
        allow_credentials:
          type: boolean
          default: false
        expose_headers:
          type: array
          items:
            type: string
            maxLength: 255 
    GestioneCors:
      type: object
      required:
        - ridefinito
      properties:
        ridefinito:
          type: boolean
          default: false
        tipo:
          $ref: '#/components/schemas/TipoGestioneCorsEnum' 
        access_control:
          $ref: '#/components/schemas/GestioneCorsAccessControl'
 
    ApiImplStato:
       type: object
       required:
          - abilitato
       properties:
          abilitato:
            type: boolean

    # --- Stato impostato a ridefinito come default per supportare in futuro la possibilità di indicare usa default o meno.
    ApiImplConfigurazioneStato:
      type: object
      properties:
        ridefinito:
          description: funzionalità non supportata al momento, indicare sempre 'true'.
          type: boolean
          default: true

    ControlloAccessiGestioneToken:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            properties:
              abilitato:
                description: indica se la gestione del token è abilitata o meno
                type: boolean
              policy:
                description: identificativo della Policy da utilizzare per la gestione del token
                type: string
                maxLength: 255
              token_opzionale:
                description: indica se la presenza del token è obbligatoria o opzionale
                type: boolean
                default: false
              validazione_jwt:
                $ref: '#/components/schemas/StatoFunzionalitaConWarningEnum'
              introspection:
                $ref: '#/components/schemas/StatoFunzionalitaConWarningEnum'
              user_info:
                $ref: '#/components/schemas/StatoFunzionalitaConWarningEnum'                
              token_forward:
                description: indica se il forward del token, nelle modalità descritte nella policy, è attivo o meno
                type: boolean
                default: true   
                           
    ControlloAccessiAutenticazione:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            properties:
              autenticazione:
                  type: object
                  oneOf:
                    - $ref: '#/components/schemas/APIImplAutenticazioneDisabilitata'             
                    - $ref: '#/components/schemas/APIImplAutenticazioneBasic'
                    - $ref: '#/components/schemas/APIImplAutenticazioneHttps'
                    - $ref: '#/components/schemas/APIImplAutenticazionePrincipal'
                    - $ref: '#/components/schemas/APIImplAutenticazioneCustom'
                  discriminator:
                    propertyName: tipo
                    mapping:
                      'disabilitato': '#/components/schemas/APIImplAutenticazioneDisabilitata'
                      'http-basic': '#/components/schemas/APIImplAutenticazioneBasic'
                      'https': '#/components/schemas/APIImplAutenticazioneHttps'
                      'principal': '#/components/schemas/APIImplAutenticazionePrincipal'
                      'custom': '#/components/schemas/APIImplAutenticazioneCustom'
              token:
                $ref: '#/components/schemas/ControlloAccessiAutenticazioneToken'
    ControlloAccessiAutenticazioneToken:
      type: object
      properties:          
        issuer:
          description: indica se nel token deve essere obbligatoriamente presente l'issuer
          type: boolean
          default: false
        client_id:
          description: indica se nel token deve essere obbligatoriamente presente l'identificativo dell'applicazione
          type: boolean
          default: false
        subject:
          description: indica se nel token deve essere obbligatoriamente presente il subject (identificativo utente codificato)
          type: boolean
          default: false
        username:
          description: indica se nel token deve essere obbligatoriamente presente l'utente (identificativo utente 'human-readable')
          type: boolean
          default: false
        email:
          description: indica se nel token deve essere obbligatoriamente presente l'email dell'utente
          type: boolean
          default: false   

    ControlloAccessiAutorizzazioneView:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            properties:
              autorizzazione:
                type: object
                oneOf:
                  - $ref: '#/components/schemas/APIImplAutorizzazioneDisabilitata'
                  - $ref: '#/components/schemas/APIImplAutorizzazioneAbilitata'
                  - $ref: '#/components/schemas/APIImplAutorizzazioneXACMLView'
                  - $ref: '#/components/schemas/APIImplAutorizzazioneCustom'
                discriminator:
                  propertyName: tipo
                  mapping:
                    'disabilitato': '#/components/schemas/APIImplAutorizzazioneDisabilitata'
                    'abilitato': '#/components/schemas/APIImplAutorizzazioneAbilitata'
                    'xacml-Policy': '#/components/schemas/APIImplAutorizzazioneXACMLView'
                    'custom': '#/components/schemas/APIImplAutorizzazioneCustom'
    ControlloAccessiAutorizzazione:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            properties:
              autorizzazione:
                type: object
                oneOf:
                  - $ref: '#/components/schemas/APIImplAutorizzazioneDisabilitata'
                  - $ref: '#/components/schemas/APIImplAutorizzazioneAbilitata'
                  - $ref: '#/components/schemas/APIImplAutorizzazioneXACML'
                  - $ref: '#/components/schemas/APIImplAutorizzazioneCustom'
                discriminator:
                  propertyName: tipo
                  mapping:
                    'disabilitato': '#/components/schemas/APIImplAutorizzazioneDisabilitata'
                    'abilitato': '#/components/schemas/APIImplAutorizzazioneAbilitata'
                    'xacml-Policy': '#/components/schemas/APIImplAutorizzazioneXACML'
                    'custom': '#/components/schemas/APIImplAutorizzazioneCustom'
    ControlloAccessiAutorizzazioneSoggetti:
      type: object
      required:
        - soggetti
      properties:
        soggetti:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/SimpleName'
          example: ['Ente1', 'Ente2', 'Ente3'] 
    ControlloAccessiAutorizzazioneSoggetto:
      type: object
      required:
        - soggetto
      properties:
        soggetto:
          $ref: 'govway_core.yaml#/components/schemas/SimpleName'
    ControlloAccessiAutorizzazioneApplicativi:
      type: object
      required:
        - applicativi
      properties:
        applicativi:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/NCName'
          example: ['Applicativo1', 'Applicativo2', 'Applicativo3']
    ControlloAccessiErogazioneAutorizzazioneApplicativi:
      type: object
      required:
        - applicativi
      properties:
        applicativi:
          type: array
          items:
            $ref: '#/components/schemas/ControlloAccessiErogazioneAutorizzazioneApplicativo'
    ControlloAccessiAutorizzazioneApplicativo:
      type: object
      required:
        - applicativo
      properties:
        applicativo:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
    ControlloAccessiErogazioneAutorizzazioneApplicativo:
      type: object
      allOf:
          - $ref: '#/components/schemas/ControlloAccessiAutorizzazioneApplicativo'
          - type: object
            properties:
              soggetto:
                $ref: 'govway_core.yaml#/components/schemas/SimpleName'
    ControlloAccessiAutorizzazioneRuoli:
      type: object
      required:
        - ruoli
      properties:
        ruoli:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/NCName'
          example: ['Ruolo1', 'Ruolo2', 'Ruolo3']
    ControlloAccessiAutorizzazioneRuolo:
      type: object
      required:
        - ruolo
      properties:
        ruolo:
          $ref: 'govway_core.yaml#/components/schemas/NCName' 
    ControlloAccessiAutorizzazioneScopes:
      type: object
      required:
        - scope
      properties:
        scope:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/NCName'
          example: ['Scope1', 'Scope2', 'Scope3']
    ControlloAccessiAutorizzazioneScope:
      type: object
      required:
        - scope
      properties:
        scope:
          $ref: 'govway_core.yaml#/components/schemas/NCName'     

    RateLimitingPolicyItem:
       type: object
       required:
        - nome
       properties:
         nome:
           $ref: 'govway_core.yaml#/components/schemas/NCName'
    ListaRateLimitingPolicy:
      type: object
      allOf:
          - $ref: 'govway_core.yaml#/components/schemas/Lista'
          - type: object
            required:
              - items
            properties:
              items:
                type: array
                items:
                  $ref: '#/components/schemas/RateLimitingPolicyItem'
                  
    RateLimitingPolicyCriteri:
       type: object
       required:
       - identificazione
       - metrica
       properties:
         identificazione:
            $ref: '#/components/schemas/RateLimitingIdentificazionePolicyEnum'
         metrica:
            $ref: '#/components/schemas/RateLimitingCriteriMetricaEnum'
         intervallo:
            $ref: '#/components/schemas/RateLimitingCriteriIntervalloEnum'
         congestione:
            type: boolean
            default: false
            example: false
         degrado:
            type: boolean
            default: false
            example: false
    RateLimitingPolicyIdentificativo:
       type: object
       required:
       - identificazione
       - policy
       properties:
         identificazione:
            $ref: '#/components/schemas/RateLimitingIdentificazionePolicyEnum'
         policy:
            $ref: 'govway_core.yaml#/components/schemas/NCName'
    RateLimitingPolicyBase:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            required:
            - nome
            - stato
            properties:
              nome:
                type: string
                maxLength: 255
              stato:
                $ref: '#/components/schemas/StatoFunzionalitaConWarningEnum'
              soglia_ridefinita:
                 type: boolean
                 default: false
              soglia_valore:
                 type: integer
                 format: int32
    RateLimitingPolicyBaseConIdentificazione:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyBase'
          - type: object
            properties:
              configurazione:
                  type: object
                  oneOf:
                    - $ref: '#/components/schemas/RateLimitingPolicyCriteri'
                    - $ref: '#/components/schemas/RateLimitingPolicyIdentificativo'
                  discriminator:
                    propertyName: identificazione
                    mapping:
                      'criteri': '#/components/schemas/RateLimitingPolicyCriteri'
                      'policy': '#/components/schemas/RateLimitingPolicyIdentificativo'
    RateLimitingPolicyErogazione:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyBaseConIdentificazione'
          - type: object
            properties:
              filtro:
                 $ref: '#/components/schemas/RateLimitingPolicyFiltroErogazione'
              raggruppamento:
                 $ref: '#/components/schemas/RateLimitingPolicyGroupBy'
    RateLimitingPolicyFruizione:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyBaseConIdentificazione'
          - type: object
            properties:
              filtro:
                 $ref: '#/components/schemas/RateLimitingPolicyFiltroFruizione'
              raggruppamento:
                 $ref: '#/components/schemas/RateLimitingPolicyGroupBy'
                 
    RateLimitingPolicyErogazioneUpdate:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyBase'
          - type: object
            properties:
              filtro:
                 $ref: '#/components/schemas/RateLimitingPolicyFiltroErogazione'
              raggruppamento:
                 $ref: '#/components/schemas/RateLimitingPolicyGroupBy'
    RateLimitingPolicyFruizioneUpdate:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyBase'
          - type: object
            properties:
              filtro:
                 $ref: '#/components/schemas/RateLimitingPolicyFiltroFruizione'
              raggruppamento:
                 $ref: '#/components/schemas/RateLimitingPolicyGroupBy'
                                 
    RateLimitingPolicyFiltro:
      type: object
      properties:
        azione:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/NCName'
        ruolo_richiedente:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
        applicativo_fruitore:
          $ref: 'govway_core.yaml#/components/schemas/NCName'
        chiave_tipo:
          $ref: '#/components/schemas/RateLimitingChiaveEnum'
        chiave_nome:
          type: string
          description: |-
            La semantica cambia in funzione del tipo:
              * header-based: nome dell'header
              * url-based: espressione regolare da applicare alla url di invocazione
              * form-based: nome del parametro della url
              * soap-action-based: in questa modalità questo parametro non viene utilizzato
              * content-based: xpath o json path da applicare sul contenuto
              * indirizzo-ip: indirizzo ip del socket
              * indirizzo-ip-forwarded: indirizzo ip inoltrato via header http
              * plugin-based: tipo del plugin
          maxLength: 255
        filtro_chiave_valore:
          type: string
          description: indica il valore che deve assumere la chiave
          maxLength: 255         
    RateLimitingPolicyFiltroErogazione:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyFiltro'
          - type: object
            properties:
              soggetto_fruitore:
                $ref: 'govway_core.yaml#/components/schemas/SimpleName'
    RateLimitingPolicyFiltroFruizione:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyFiltro'

    RateLimitingPolicyGroupBy:
      type: object
      properties:
        azione:
          type: boolean
          default: false
        richiedente:
          type: boolean
          default: false
        token:
          type: array
          items:
            $ref: 'govway_core.yaml#/components/schemas/TokenClaimEnum'
          example: [subject, issuer] 
        chiave_tipo:
          $ref: '#/components/schemas/RateLimitingChiaveEnum'
        chiave_nome:
          type: string
          description: |-
            La semantica cambia in funzione del tipo:
              * header-based: nome dell'header
              * url-based: espressione regolare da applicare alla url di invocazione
              * form-based: nome del parametro della url
              * soap-action-based: in questa modalità questo parametro non viene utilizzato
              * content-based: xpath o json path da applicare sul contenuto
              * indirizzo-ip: indirizzo ip del socket
              * indirizzo-ip-forwarded: indirizzo ip inoltrato via header http
              * plugin-based: tipo del plugin
          maxLength: 255
                    
    RateLimitingPolicyErogazioneView:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyErogazione'
          - type: object
            required:
            - descrizione
            properties:
              descrizione:
                type: string
    RateLimitingPolicyFruizioneView:
       type: object
       allOf:
          - $ref: '#/components/schemas/RateLimitingPolicyFruizione'
          - type: object
            required:
            - descrizione
            properties:
              descrizione:
                type: string

    Validazione:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            required:
            - stato
            - tipo
            properties:
              stato:
                $ref: '#/components/schemas/StatoFunzionalitaConWarningEnum'
              tipo:
                $ref: '#/components/schemas/TipoValidazioneEnum'
              mtom:
                type: boolean
                default: false
                example: false
                
    CachingRisposta:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            required:
            - stato
            properties:
              stato:
                $ref: '#/components/schemas/StatoDefaultRidefinitoEnum'
              abilitato:
                type: boolean
              cache_timeout_seconds:
                type: integer
                format: int32
              max_response_size:
                type: boolean
              max_response_size_kb:
                type: integer
                format: int64
              hash_request_uri:
                type: boolean
                default: true
              hash_all_query_parameters:
                type: boolean
                default: true
              hash_query_paramaters:
                type: array
                items:
                  type: string
                  maxLength: 255
              hash_headers:
                type: array
                items:
                  type: string
                  maxLength: 255
              hash_payload:
                type: boolean
                default: true
              control_no_cache:
                type: boolean
                default: true
              control_no_store:
                type: boolean
                default: true
              control_max_age:
                type: boolean
                default: true
              regole:
                type: array
                items:
                  $ref: '#/components/schemas/CachingRispostaRegola'
    CachingRispostaRegola:
       type: object
       properties:
          return-code-min:
            $ref: 'govway_core.yaml#/components/schemas/HttpStatusCode'
          return-code-max:
            $ref: 'govway_core.yaml#/components/schemas/HttpStatusCode'
          fault:
            type: boolean
            default: false
          cache_timeout_seconds:
            type: integer
            format: int32

    CorrelazioneApplicativaRichiestaItem:
       type: object
       required:
         - elemento
         - identificazione_tipo
       properties:
          elemento:
            type: string
            maxLength: 255
          identificazione_tipo:
            $ref: '#/components/schemas/CorrelazioneApplicativaRichiestaEnum'
    CorrelazioneApplicativaRispostaItem:
       type: object
       required:
         - elemento
         - identificazione_tipo
       properties:
          elemento:
            type: string
            maxLength: 255
          identificazione_tipo:
            $ref: '#/components/schemas/CorrelazioneApplicativaRispostaEnum'
  
    ListaCorrelazioneApplicativaRichiesta:
      type: object
      allOf:
          - $ref: 'govway_core.yaml#/components/schemas/Lista'
          - type: object
            required:
              - items
            properties:
              items:
                type: array
                items:
                  $ref: '#/components/schemas/CorrelazioneApplicativaRichiestaItem'
    ListaCorrelazioneApplicativaRisposta:
      type: object
      allOf:
          - $ref: 'govway_core.yaml#/components/schemas/Lista'
          - type: object
            required:
              - items
            properties:
              items:
                type: array
                items:
                  $ref: '#/components/schemas/CorrelazioneApplicativaRispostaItem'
          
    CorrelazioneApplicativaBase:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            properties:
              elemento:
                type: string
                maxLength: 255
              generazione_errore_identificazione_fallita:
                type: boolean
                default: true
    CorrelazioneApplicativaRichiesta:
       type: object
       allOf:
          - $ref: '#/components/schemas/CorrelazioneApplicativaBase'
          - type: object
            required:
            - identificazione_tipo
            properties:
              identificazione_tipo:
                $ref: '#/components/schemas/CorrelazioneApplicativaRichiestaEnum'
              identificazione:
                type: string
                description: |-
                  La semantica cambia in funzione del tipo:
                    * header-based: nome dell'header
                    * url-based: espressione regolare da applicare alla url di invocazione
                    * content-based: xpath o json path da applicare sul contenuto
                    * input-based: questo field non deve essere valorizzato poichè l'informazione applicativa viene estratta dagli header di integrazione
                    * disabilitato:  questo field non deve essere valorizzato poichè la funzionalità di estrazione è disabilitata
    CorrelazioneApplicativaRisposta:
       type: object
       allOf:
          - $ref: '#/components/schemas/CorrelazioneApplicativaBase'
          - type: object
            required:
            - identificazione_tipo
            properties:
              identificazione_tipo:
                $ref: '#/components/schemas/CorrelazioneApplicativaRispostaEnum'
              identificazione:
                type: string
                description: |-
                  La semantica cambia in funzione del tipo:
                    * header-based: nome dell'header
                    * content-based: xpath o json path da applicare sul contenuto
                    * input-based: questo field non deve essere valorizzato poichè l'informazione applicativa viene estratta dagli header di integrazione
                    * disabilitato:  questo field non deve essere valorizzato poichè la funzionalità di estrazione è disabilitata

    RegistrazioneMessaggi:
       type: object
       allOf:
          - $ref: '#/components/schemas/ApiImplConfigurazioneStato'
          - type: object
            required:
            - stato
            properties:
              stato:
                $ref: '#/components/schemas/StatoDefaultRidefinitoEnum'
              richiesta:
                $ref: '#/components/schemas/RegistrazioneMessaggiConfigurazione'
              risposta:
                $ref: '#/components/schemas/RegistrazioneMessaggiConfigurazione'
    RegistrazioneMessaggiConfigurazione:
      type: object
      required:
        - abilitato
      properties:
        abilitato:
          type: boolean
        ingresso:
          $ref: '#/components/schemas/RegistrazioneMessaggiConfigurazioneRegola'
        uscita:
          $ref: '#/components/schemas/RegistrazioneMessaggiConfigurazioneRegola'
    RegistrazioneMessaggiConfigurazioneRegola:
      type: object
      required:
        - headers
        - body
        - attachments
      properties:
        headers:
          type: boolean
        body:
          type: boolean
        attachments:
          type: boolean
          
    # Base: Enumeration
    FormatoSoapEnum:
      type: string
      enum: ['Wsdl1.1']
      default: 'Wsdl1.1'
    FormatoRestEnum:
      type: string
      enum: ['Wadl', 'Swagger2.0','OpenApi3.0']
      default: 'OpenApi3.0'
    TipoApiEnum:
      type: string
      enum: ['soap', 'rest']
      example: 'rest'
    StatoApiEnum:
      type: string
      enum: ['ok', 'warn','error']
    DominioEnum:
      type: string
      enum: ['interno', 'esterno']
      example: 'esterno'
    ModalitaAccessoEnum:
      type: string
      enum: ['http-basic', 'https', 'principal']
      example: 'http-basic'
    ContestoEnum:
      type: string
      enum: ['qualsiasi', 'erogazione', 'fruizione']
      example: 'qualsiasi'
      default: 'qualsiasi'
    FonteEnum:
      type: string
      enum: ['qualsiasi', 'registro', 'esterna']
      example: 'qualsiasi'
      default: 'qualsiasi'
    RuoloAllegatoAPI:
      type: string
      enum: ['allegato', 'specificaSemiFormale']
      default: allegato
      example: 'specificaSemiFormale'
    RuoloAllegatoAPIImpl:
      type: string
      enum: ['allegato', 'specificaSemiFormale', 'specificaSicurezza', 'specificaLivelloServizio' ]
      default: allegato
      example: 'specificaSemiFormale'
    TipoSpecificaSemiformaleEnum:
      type: string
      enum: ['UML', 'HTML', 'XSD', 'XML', 'JSON', 'YAML', 'Linguaggio Naturale']
      example: 'XML'
    TipoSpecificaSicurezzaEnum:
      type: string
      enum: ['WS-Policy', 'XACML-Policy', 'Linguaggio Naturale']
      example: 'XACML-Policy'      
    TipoSpecificaLivelloServizioEnum:
      type: string
      enum: ['WS-Agreement', 'WSLA']
      example: 'WSLA'
    HttpMethodEnum:
      type: string
      enum: ['Qualsiasi', 'GET', 'POST', 'PUT', 'DELETE', 'OPTIONS', 'HEAD', 'TRACE', 'PATCH', 'LINK', 'UNLINK']
      example: 'POST'
    SslTipologiaEnum:
      type: string
      enum: ['SSLv2Hello', 'SSLv3', 'TLSv1', 'TLSv1.1', 'TLSv1.2', 'TLSv1.3']
      example: 'TLSv1.2'
      default: 'TLSv1.3'
    KeystoreEnum:
      type: string
      enum: ['jks', 'pkcs12', 'jceks', 'bks', 'uber', 'gkr']
      example: 'jks' 
    TipoAutenticazioneEnum:
      type: string
      enum: ['disabilitato', 'http-basic', 'https', 'principal', 'custom']
      example: 'http-basic' 
    TipoAutenticazioneHttps:
      type: string
      enum: ['certificato', 'configurazione-manuale']
      example: 'certificato'
    TipoAutenticazionePrincipal:
      type: string
      enum: ['container', 'header-based', 'form-based', 'url-based', 'ip-address', 'ip-address-forwarded-for', 'token']
      example: 'container'  
    TipoAutenticazionePrincipalToken:
      type: string
      enum: ['subject', 'clientId', 'username', 'eMail', 'custom']
      example: 'clientId'  
    TipoKeystore:
      type: string
      enum: ['JKS', 'PKCS12', 'CER']
      example: 'JKS'
    TipoAutorizzazioneEnum:
      type: string
      enum: ['disabilitato', 'abilitato', 'xacml-Policy', 'custom']
      example: 'abilitato'
    AllAnyEnum:
      type: string
      enum: ['all', 'any']
      example: 'all'
      default: 'all'    
    ModalitaIdentificazioneAzioneEnum:
      type: string
      enum: ['content-based', 'header-based', 'input-based', 'interface-based', 'soap-action-based', 'url-based', 'protocol-based']
      example: 'interface-based'   
    TipoGestioneCorsEnum:
      type: string
      enum: ['disabilitato', 'gateway', 'applicativo']
      example: 'gateway'
    ModalitaConfigurazioneGruppoEnum:
      type: string
      enum: ['eredita', 'nuova']
      example: 'eredita'
    StatoFunzionalitaConWarningEnum:
      type: string
      enum: ['abilitato', 'disabilitato', 'warningOnly']
      example: 'abilitato'
    TipoValidazioneEnum:
      type: string
      enum: ['interface', 'xsd']
      example: 'interface'
    StatoDefaultRidefinitoEnum:
      type: string
      enum: ['default', 'ridefinito']
      example: 'ridefinito'
    RateLimitingIdentificazionePolicyEnum:
      type: string
      enum: ['criteri', 'policy']
      example: 'criteri'
    RateLimitingCriteriMetricaEnum:
      type: string
      enum: 
        - 'numero-richieste'
        - 'numero-richieste-simultanee'
        - 'occupazione-banda'
        - 'tempo-medio-risposta'
        - 'tempo-complessivo-risposta'
        - 'numero-richieste-ok'
        - 'numero-richieste-fallite'
        - 'numero-fault-applicativi'
        - 'numero-richieste-fallite-o-fault-applicativi'
      example: 'numero-richieste'
    RateLimitingCriteriIntervalloEnum:
      type: string
      enum: ['minuti', 'orario', 'giornaliero']
      example: 'giornaliero'
    RateLimitingChiaveEnum:
      type: string
      enum: ['content-based', 'header-based', 'soap-action-based', 'url-based', 'form-based', 'indirizzo-ip', 'indirizzo-ip-forwarded', 'plugin-based']
      example: 'content-based'   
    CorrelazioneApplicativaRichiestaEnum:
      type: string
      enum: ['content-based', 'header-based', 'url-based', 'input-based', 'disabilitato']
      example: 'content-based'
    CorrelazioneApplicativaRispostaEnum:
      type: string
      enum: ['content-based', 'header-based', 'input-based', 'disabilitato']
      example: 'content-based'   
