
<project name="setup-batchStatistiche" basedir=".">
	
	<description>
        	SETUP BATCH STATISTICHE
	</description>

	<import file="../../commons/utils.xml" />
	
	<!-- batch-statistiche.properties -->
	<target name="batch_statistiche_properties_settings">

		<concat destfile="${file}" append="yes" >

# ----- Personalizzazione Setup GovWay -------------
		</concat>

		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="statistiche.generazione.forceIndex.repository"/>
			<param name="value" value="${work_dir}/generazioneStatistiche.forceIndex.properties"/>
		</antcall>
		
		<!-- LOG (sul batch li lascio attivi) -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="statistiche.generazione.debug"/>
			<param name="value" value="true"/>
		</antcall>

		<!-- 
		  PROTOCOL DEFAULT
		  se abilitati verrano scelto nell'ordine:
		  - trasparente
		  - modipa
		  - spcoop
		  - as4
		  - sdi
		-->
		<if>
			<istrue value="${antinstaller_protocollo_trasparente}"/>
			<then>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="protocolloDefault"/>
					<param name="value" value="trasparente"/>
				</antcall>
			</then>
			<elseif>
				<istrue value="${antinstaller_protocollo_modipa}"/>
				<then>
					<antcall target="set_property">
					    <param name="file" value="${file}"/>
						<param name="token" value="protocolloDefault"/>
						<param name="value" value="modipa"/>
					</antcall>
				</then>
			</elseif>
			<elseif>
				<istrue value="${antinstaller_protocollo_spcoop}"/>
				<then>
					<antcall target="set_property">
					    <param name="file" value="${file}"/>
						<param name="token" value="protocolloDefault"/>
						<param name="value" value="spcoop"/>
					</antcall>
				</then>
			</elseif>
			<elseif>
				<istrue value="${antinstaller_protocollo_as4}"/>
				<then>
					<antcall target="set_property">
					    <param name="file" value="${file}"/>
						<param name="token" value="protocolloDefault"/>
						<param name="value" value="as4"/>
					</antcall>
				</then>
			</elseif>
			<elseif>
				<istrue value="${antinstaller_protocollo_sdi}"/>
				<then>
					<antcall target="set_property">
					    <param name="file" value="${file}"/>
						<param name="token" value="protocolloDefault"/>
						<param name="value" value="sdi"/>
					</antcall>
				</then>
			</elseif>
		</if>

		<!-- ENV REQUIRED -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="env.conf.required"/>
			<param name="value" value="${antinstaller_confDir_env}"/>
		</antcall>
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="env.log.required"/>
			<param name="value" value="${antinstaller_logDir_env}"/>
		</antcall>
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="env.dbType.required"/>
			<param name="value" value="false"/>
		</antcall>
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="env.defaultEntityName.required"/>
			<param name="value" value="${antinstaller_entity_env}"/>
		</antcall>

		<!-- BouncyCastle -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="security.addBouncyCastleProvider"/>
			<param name="value" value="true"/>
		</antcall>
		
		<!-- MAP -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="env.map.config"/>
			<param name="value" value="${work_dir}/govway.map.properties"/>
		</antcall>
	
		<!-- HSM CONFIG DIR -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="hsm.config"/>
			<param name="value" value="${work_dir}/hsm.properties"/>
		</antcall>
		
		<!-- BYOK -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="byok.config"/>
			<param name="value" value="${work_dir}/byok.properties"/>
		</antcall>
		
		<!-- Secrets -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="byok.env.secrets.config"/>
			<param name="value" value="${work_dir}/govway.secrets.properties"/>
		</antcall>
		
		<!-- TracingPDND -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="statistiche.pdnd.tracciamento.baseUrl"/>
			<param name="value" value="http://localhost:8080/govway/rest/out/${entity_name}/PDND/api-pdnd-tracing/v1"/>
		</antcall>
		
	</target>
	
	<!-- daoFactory.properties -->
	<target name="batch_statistiche_dao_factory_properties_settings">
		
		<concat destfile="${file}" append="yes" >

# ----- Personalizzazione Setup GovWay -------------
		</concat>
				
		<!-- TIPO DATABASE -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="db.tipoDatabase"/>
			<param name="value" value="${antinstaller_tipo_database}"/>
		</antcall>

		<!-- Driver JDBC -->
		<antcall target="set_property">
		    <param name="file" value="${file}"/>
			<param name="token" value="db.connection.driver"/>
			<param name="value" value="${antinstaller_driver_jdbc_classname}"/>
		</antcall>

		<!-- Connection URL -->
		<if>
			<equals arg1="${antinstaller_config_db}" arg2="config"/>
			<then>
				<antcall target="-set_connection_url_jdbc">
				    <param name="file" value="${file}"/>
					<param name="jdbc_token" value="db.connection.url"/>
					<param name="jdbc_tipo_database" value="${antinstaller_tipo_database}"/>
					<param name="jdbc_dbhost" value="${antinstaller_dbhost_config}"/>
					<param name="jdbc_dbport" value="${antinstaller_dbport_config}"/>
					<param name="jdbc_dbname" value="${antinstaller_dbname_config}"/>
					<param name="jdbc_oracle_mode" value="${antinstaller_oracle_mode_config}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="db.connection.user"/>
					<param name="value" value="${antinstaller_dbusername_config}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="db.connection.password"/>
					<param name="value" value="${antinstaller_dbpassword_config}"/>
				</antcall>

				<if>
					<equals arg1="${antinstaller_log_db}" arg2="runtime"/>
					<then>
						<antcall target="-set_connection_url_jdbc">
						    <param name="file" value="${file}"/>
							<param name="jdbc_token" value="factory.transazioni.db.connection.url"/>
							<param name="jdbc_tipo_database" value="${antinstaller_tipo_database}"/>
							<param name="jdbc_dbhost" value="${antinstaller_dbhost}"/>
							<param name="jdbc_dbport" value="${antinstaller_dbport}"/>
							<param name="jdbc_dbname" value="${antinstaller_dbname}"/>
							<param name="jdbc_oracle_mode" value="${antinstaller_oracle_mode}"/>
						</antcall>
						<antcall target="set_property">
						    <param name="file" value="${file}"/>
							<param name="token" value="factory.transazioni.db.connection.user"/>
							<param name="value" value="${antinstaller_dbusername}"/>
						</antcall>
						<antcall target="set_property">
						    <param name="file" value="${file}"/>
							<param name="token" value="factory.transazioni.db.connection.password"/>
							<param name="value" value="${antinstaller_dbpassword}"/>
						</antcall>
					</then>
				</if>
				<if>
					<equals arg1="${antinstaller_stats_db}" arg2="runtime"/>
					<then>
						<antcall target="-set_connection_url_jdbc">
						    <param name="file" value="${file}"/>
							<param name="jdbc_token" value="factory.statistiche.db.connection.url"/>
							<param name="jdbc_tipo_database" value="${antinstaller_tipo_database}"/>
							<param name="jdbc_dbhost" value="${antinstaller_dbhost}"/>
							<param name="jdbc_dbport" value="${antinstaller_dbport}"/>
							<param name="jdbc_dbname" value="${antinstaller_dbname}"/>
							<param name="jdbc_oracle_mode" value="${antinstaller_oracle_mode}"/>
						</antcall>
						<antcall target="set_property">
						    <param name="file" value="${file}"/>
							<param name="token" value="factory.statistiche.db.connection.user"/>
							<param name="value" value="${antinstaller_dbusername}"/>
						</antcall>
						<antcall target="set_property">
						    <param name="file" value="${file}"/>
							<param name="token" value="factory.statistiche.db.connection.password"/>
							<param name="value" value="${antinstaller_dbpassword}"/>
						</antcall>
					</then>
				</if>
			</then>
			<else>
				<antcall target="-set_connection_url_jdbc">
				    <param name="file" value="${file}"/>
					<param name="jdbc_token" value="db.connection.url"/>
					<param name="jdbc_tipo_database" value="${antinstaller_tipo_database}"/>
					<param name="jdbc_dbhost" value="${antinstaller_dbhost}"/>
					<param name="jdbc_dbport" value="${antinstaller_dbport}"/>
					<param name="jdbc_dbname" value="${antinstaller_dbname}"/>
					<param name="jdbc_oracle_mode" value="${antinstaller_oracle_mode}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="db.connection.user"/>
					<param name="value" value="${antinstaller_dbusername}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="db.connection.password"/>
					<param name="value" value="${antinstaller_dbpassword}"/>
				</antcall>
			</else>
		</if>
		<if>
			<equals arg1="${antinstaller_log_db}" arg2="log"/>
			<then>
				<antcall target="-set_connection_url_jdbc">
				    <param name="file" value="${file}"/>
					<param name="jdbc_token" value="factory.transazioni.db.connection.url"/>
					<param name="jdbc_tipo_database" value="${antinstaller_tipo_database}"/>
					<param name="jdbc_dbhost" value="${antinstaller_dbhost_log}"/>
					<param name="jdbc_dbport" value="${antinstaller_dbport_log}"/>
					<param name="jdbc_dbname" value="${antinstaller_dbname_log}"/>
					<param name="jdbc_oracle_mode" value="${antinstaller_oracle_mode_log}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="factory.transazioni.db.connection.user"/>
					<param name="value" value="${antinstaller_dbusername_log}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="factory.transazioni.db.connection.password"/>
					<param name="value" value="${antinstaller_dbpassword_log}"/>
				</antcall>
			</then>
		</if>
		<if>
			<equals arg1="${antinstaller_stats_db}" arg2="log"/>
			<then>
				<antcall target="-set_connection_url_jdbc">
				    <param name="file" value="${file}"/>
					<param name="jdbc_token" value="factory.statistiche.db.connection.url"/>
					<param name="jdbc_tipo_database" value="${antinstaller_tipo_database}"/>
					<param name="jdbc_dbhost" value="${antinstaller_dbhost_log}"/>
					<param name="jdbc_dbport" value="${antinstaller_dbport_log}"/>
					<param name="jdbc_dbname" value="${antinstaller_dbname_log}"/>
					<param name="jdbc_oracle_mode" value="${antinstaller_oracle_mode_log}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="factory.statistiche.db.connection.user"/>
					<param name="value" value="${antinstaller_dbusername_log}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="factory.statistiche.db.connection.password"/>
					<param name="value" value="${antinstaller_dbpassword_log}"/>
				</antcall>
			</then>
		</if>
		<if>
			<equals arg1="${antinstaller_stats_db}" arg2="stats"/>
			<then>
				<antcall target="-set_connection_url_jdbc">
				    <param name="file" value="${file}"/>
					<param name="jdbc_token" value="factory.statistiche.db.connection.url"/>
					<param name="jdbc_tipo_database" value="${antinstaller_tipo_database}"/>
					<param name="jdbc_dbhost" value="${antinstaller_dbhost_stats}"/>
					<param name="jdbc_dbport" value="${antinstaller_dbport_stats}"/>
					<param name="jdbc_dbname" value="${antinstaller_dbname_stats}"/>
					<param name="jdbc_oracle_mode" value="${antinstaller_oracle_mode_stats}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="factory.statistiche.db.connection.user"/>
					<param name="value" value="${antinstaller_dbusername_stats}"/>
				</antcall>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="factory.statistiche.db.connection.password"/>
					<param name="value" value="${antinstaller_dbpassword_stats}"/>
				</antcall>
			</then>
		</if>
				
	</target>

	<target name="-set_connection_url_jdbc">
		
		<if>
			<equals arg1="${jdbc_tipo_database}" arg2="db2"/>
			<then>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="${jdbc_token}"/>
					<param name="value" value="jdbc:db2://${jdbc_dbhost}:${jdbc_dbport}/${jdbc_dbname}"/>
				</antcall>
			</then>
		</if>
		<if>
			<equals arg1="${jdbc_tipo_database}" arg2="hsql"/>
			<then>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="${jdbc_token}"/>
					<param name="value" value="jdbc:hsqldb:hsql://${jdbc_dbhost}:${jdbc_dbport}/${jdbc_dbname}"/>
				</antcall>
			</then>
		</if>
		<if>
			<equals arg1="${jdbc_tipo_database}" arg2="mysql"/>
			<then>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="${jdbc_token}"/>
					<param name="value" value="jdbc:mysql://${jdbc_dbhost}:${jdbc_dbport}/${jdbc_dbname}?zeroDateTimeBehavior=convertToNull"/>
				</antcall>
			</then>
		</if>
		<if>
			<equals arg1="${jdbc_tipo_database}" arg2="oracle"/>
			<then>
				<if>
					<equals arg1="${jdbc_oracle_mode}" arg2="serviceName" />
					<then>
						<antcall target="set_property">
						    <param name="file" value="${file}"/>
							<param name="token" value="${jdbc_token}"/>
							<param name="value" value="jdbc:oracle:thin:@${jdbc_dbhost}:${jdbc_dbport}/${jdbc_dbname}"/>
						</antcall>
					</then>
					<else>
						<antcall target="set_property">
						    <param name="file" value="${file}"/>
							<param name="token" value="${jdbc_token}"/>
							<param name="value" value="jdbc:oracle:thin:@${jdbc_dbhost}:${jdbc_dbport}:${jdbc_dbname}"/>
						</antcall>
					</else>
				</if>
			</then>
		</if>
		<if>
			<equals arg1="${jdbc_tipo_database}" arg2="postgresql"/>
			<then>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="${jdbc_token}"/>
					<param name="value" value="jdbc:postgresql://${jdbc_dbhost}:${jdbc_dbport}/${jdbc_dbname}"/>
				</antcall>
			</then>
		</if>
		<if>
			<equals arg1="${jdbc_tipo_database}" arg2="sqlserver"/>
			<then>
				<antcall target="set_property">
				    <param name="file" value="${file}"/>
					<param name="token" value="${jdbc_token}"/>
					<param name="value" value="jdbc:sqlserver://${jdbc_dbhost}:${jdbc_dbport};databaseName=${jdbc_dbname}"/>
				</antcall>
			</then>
		</if>
	</target>
	
	<!-- batch-statistiche.log4j2.properties -->
	<target name="batch_statistiche_log4j_properties_settings">

		<concat destfile="${file}" append="yes" >

# ----- Personalizzazione Setup GovWay -------------
		</concat>
		
		<!-- WORKING DIR -->
		<antcall target="replace_token">
		    <param name="file" value="${file}"/>
			<param name="token" value="/var/govway/log"/>
			<param name="value" value="${log_dir}"/>
		</antcall>
	

		<if>
			<equals arg1="${antinstaller_batch_system_out}" arg2="true" />
			<then>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_statistiche_orarie_generazione.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_statistiche_orarie_generazione.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_statistiche_orarie_generazione_error.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_statistiche_orarie_generazione_error.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.org_govway.appenderRef.stdout.ref"/>
					<param name="value" value="logger.org_govway.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_statistiche_giornaliere_generazione.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_statistiche_giornaliere_generazione.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_statistiche_giornaliere_generazione_error.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_statistiche_giornaliere_generazione_error.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_statistiche_settimanali_generazione.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_statistiche_settimanali_generazione.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_statistiche_settimanali_generazione_error.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_statistiche_settimanali_generazione_error.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_statistiche_mensili_generazione.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_statistiche_mensili_generazione.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_statistiche_mensili_generazione_error.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_statistiche_mensili_generazione_error.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_pdnd_tracciamento_generazione.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_pdnd_tracciamento_generazione.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_pdnd_tracciamento_generazione_error.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_pdnd_tracciamento_generazione_error.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_pdnd_tracciamento_pubblicazione.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_pdnd_tracciamento_pubblicazione.appenderRef.stdout.ref"/>
				</antcall>
				<antcall target="replace_token">
				    <param name="file" value="${file}"/>
					<param name="token" value="#logger.govway_batch_pdnd_tracciamento_pubblicazione_error.appenderRef.stdout.ref"/>
					<param name="value" value="logger.govway_batch_pdnd_tracciamento_pubblicazione_error.appenderRef.stdout.ref"/>
				</antcall>
			</then>
		</if>
	</target>
	
	<!-- Modifica gli script batch per gestire dinamicamente env.defaultEntityName.required -->
	<target name="_batch_statistiche_entity_required_scripts">

		<!-- Script .sh che devono impostare env.defaultEntityName.required=false (generaStatistiche* e generaReportPDND) -->
		<foreach target="_batch_statistiche_add_entity_required_sh" param="script_file" delimiter=";">
			<path>
				<fileset dir="${batch_dir}">
					<include name="generaStatistiche*.sh"/>
					<include name="generaReportPDND.sh"/>
				</fileset>
			</path>
			<param name="entity_required_value" value="false"/>
		</foreach>

		<!-- Script .sh che devono impostare env.defaultEntityName.required=true (pubblicaReportPDND) -->
		<foreach target="_batch_statistiche_add_entity_required_sh" param="script_file" delimiter=";">
			<path>
				<fileset dir="${batch_dir}">
					<include name="pubblicaReportPDND.sh"/>
				</fileset>
			</path>
			<param name="entity_required_value" value="true"/>
		</foreach>

		<!-- Script .cmd che devono impostare env.defaultEntityName.required=false (generaStatistiche* e generaReportPDND) -->
		<foreach target="_batch_statistiche_add_entity_required_cmd" param="script_file" delimiter=";">
			<path>
				<fileset dir="${batch_dir}">
					<include name="generaStatistiche*.cmd"/>
					<include name="generaReportPDND.cmd"/>
				</fileset>
			</path>
			<param name="entity_required_value" value="false"/>
		</foreach>

		<!-- Script .cmd che devono impostare env.defaultEntityName.required=true (pubblicaReportPDND) -->
		<foreach target="_batch_statistiche_add_entity_required_cmd" param="script_file" delimiter=";">
			<path>
				<fileset dir="${batch_dir}">
					<include name="pubblicaReportPDND.cmd"/>
				</fileset>
			</path>
			<param name="entity_required_value" value="true"/>
		</foreach>

	</target>

	<!-- Aggiunge il comando sed negli script .sh per modificare env.defaultEntityName.required -->
	<target name="_batch_statistiche_add_entity_required_sh">

		<!-- Determina il valore opposto per il sed (sostituisce l'altro valore con quello desiderato) -->
		<if>
			<equals arg1="${entity_required_value}" arg2="false"/>
			<then>
				<var name="entity_required_opposite" value="true"/>
			</then>
			<else>
				<var name="entity_required_opposite" value="false"/>
			</else>
		</if>

		<!-- Aggiunge la riga sed prima del comando COMMAND= -->
		<replace file="${script_file}"
			token="COMMAND=&quot;$${JAVA_HOME}/bin/java&quot;"
			value="# Imposta env.defaultEntityName.required a ${entity_required_value} prima dell'esecuzione${line.separator}sed -i 's/env.defaultEntityName.required=${entity_required_opposite}/env.defaultEntityName.required=${entity_required_value}/g' &quot;$${BATCH_CONFIG}/batch-statistiche.properties&quot;${line.separator}${line.separator}COMMAND=&quot;$${JAVA_HOME}/bin/java&quot;"/>
	</target>

	<!-- Aggiunge il comando powershell negli script .cmd per modificare env.defaultEntityName.required -->
	<target name="_batch_statistiche_add_entity_required_cmd">

		<!-- Determina il valore opposto -->
		<if>
			<equals arg1="${entity_required_value}" arg2="false"/>
			<then>
				<var name="entity_required_opposite" value="true"/>
			</then>
			<else>
				<var name="entity_required_opposite" value="false"/>
			</else>
		</if>

		<!-- Aggiunge il comando powershell prima del comando set COMMAND= -->
		<replace file="${script_file}"
			token="set COMMAND=&quot;%JAVA_HOME%\bin\java&quot;"
			value="REM Imposta env.defaultEntityName.required a ${entity_required_value} prima dell'esecuzione${line.separator}powershell -Command &quot;(Get-Content '%BATCH_CONFIG%\batch-statistiche.properties') -replace 'env.defaultEntityName.required=${entity_required_opposite}', 'env.defaultEntityName.required=${entity_required_value}' | Set-Content '%BATCH_CONFIG%\batch-statistiche.properties'&quot;${line.separator}${line.separator}set COMMAND=&quot;%JAVA_HOME%\bin\java&quot;"/>
	</target>	
		
</project>
